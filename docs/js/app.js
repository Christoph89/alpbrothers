"use strict";var $alpbros,__extends=this&&this.__extends||function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var t,n;(t=e.Roles||(e.Roles={}))[t.WWW=1]="WWW",t[t.Admin=2]="Admin",t[t.Partner=3]="Partner",(n=e.MTBLevel||(e.MTBLevel={}))[n.Everyone=0]="Everyone",n[n.Beginner=1]="Beginner",n[n.Advanced=2]="Advanced",n[n.All=3]="All"}($alpbros||($alpbros={})),function(o){!function(e){function a(e,t){return e.year()==t.year()&&e.month()==t.month()&&e.date()==t.date()}function n(e,t){return e&&e.isValid()?(0==e.hour()&&0==e.minute()&&(e.hour(t.hour()),e.minute(t.minute())),e):t?t.clone():null}function i(e){if(!e)return{};var n={};return $q(e.split("&")).ForEach(function(e){var t=e.split("=");n[decodeURIComponent(t[0])]=decodeURIComponent(t[1])}),n}e.formatDate=function(e,t){return e.format(t)},e.formatFromTo=function(e,t,n,r){r&&!a(e,t)&&(n=r);var i=n.split("-");return e.format(i[0].trim())+" - "+t.format(i[1].trim())},e.dateEquals=a,e.mergeDates=n,e.mergeDatesStr=function(e,t){return n(moment(e||null),moment(t||null))},e.ensureStartsWith=function(e,t){return null==e&&(e=""),e[0]==t?e:t+e},e.getOffset=function(e,t){if(void 0===t&&(t="top"),0==(e="string"==typeof e?$(e):e).length)return null;var n=e.offset().top;return"middle"==t?n-($(window).height()-e.outerHeight())/2:Math.max(n,0)},e.localize=function(e,t){if(!e)return null;t||(t="name");var n=e[t+"_"+o.$cfg.lang];return void 0===n&&(n=e[t]),n},e.getPage=function(e){for(var t=e;t&&!t.hasClass("page");)t=t.parent();return t.hasClass("page")?t.data("page"):null},e.parseUrl=function(e){var t={hash:"#/"+(e=e.replace("#/","").replace("#",""))},n=e.split("?"),r=(n[0]||"").split("/");return t.page=r[0],"cmd"==t.page||o.$pages.exists(t.page)?t.dest=r[r.length-1]:(t.dest=t.page,t.page="main"),t.args=i(n[1]),t},e.splitArgs=i,e.formatMd=function(e){var n=0,r=0,i=0;return e.replace(/\*\*/g,function(e,t){return++n%2==1?"<b>":"</b>"}).replace(/\*/g,function(e,t){return++r%2==1?"<strong>":"</strong>"}).replace(/_/g,function(e,t){return++i%2==1?"<i>":"</i>"})},e.trim=function(e,t){return"]"===t&&(t="\\]"),"\\"===t&&(t="\\\\"),e.replace(new RegExp("^["+t+"]+|["+t+"]+$","g"),"")},e.trimStart=function(e,t){return"]"===t&&(t="\\]"),"\\"===t&&(t="\\\\"),e.replace(new RegExp("^["+t+"]","g"),"")},e.expandPath=function(e,t){for(var n=t.split("."),r=0;r<n.length;r++)e=e[n[r]];return e},String.prototype.format=function(){var e=this,t=arguments;if(!t||!t.length)return e;for(var n in 1==t.length&&"object"==typeof t[0]&&(t=t[0]),t)e=e.replace("{"+n+"}",t[n]);return e}}(o.$util||(o.$util={}))}($alpbros||($alpbros={})),function(t){var n;(n=t.$cfg||(t.$cfg={})).init=function(e){$.extend(this,e),t.$res=e.res,$q(t.MTBEventTypes).ForEach(function(e){return $.extend(e.Value,t.$res.eventTypes[e.Key])}),moment.locale(n.lang),$q(n.pages).ForEach(function(t){$q(t.Value.synonyms).ForEach(function(e){n.pages[e]={name:e,preload:!1,synonyms:[],synname:t.Key}})})}}($alpbros||($alpbros={})),function(e){e.MTBEventTypes={},e.MTBEventTypes[0]=e.MTBEventTypes.None={id:0,name:"None",description:"@@cfg",icon:"@@cfg",duration:0},e.MTBEventTypes[1]=e.MTBEventTypes.TechniqueTraining={id:1,name:"TechniqueTraining",description:"@@cfg",icon:"@@cfg",duration:3.5},e.MTBEventTypes[2]=e.MTBEventTypes.GuidedTour={id:2,name:"GuidedTour",description:"@@cfg",icon:"@@cfg",duration:4},e.MTBEventTypes[3]=e.MTBEventTypes.EBikeTour={id:3,name:"EBikeTour",description:"@@cfg",icon:"@@cfg",duration:4},e.MTBEventTypes[4]=e.MTBEventTypes.Camp={id:4,name:"Camp",description:"@@cfg",icon:"@@cfg",duration:72},e.MTBEventTypes[5]=e.MTBEventTypes.MechanicalTraining={id:5,name:"MechanicalTraining",description:"@@cfg",icon:"@@cfg",duration:2}}($alpbros||($alpbros={})),function(r){var e,t,n;(e=r.MTBEventStatus||(r.MTBEventStatus={}))[e.TakesPlace=0]="TakesPlace",e[e.InProgress=1]="InProgress",e[e.Canceled=2]="Canceled",e[e.Deleted=3]="Deleted",(n=t=r.MTBEventRegType||(r.MTBEventRegType={}))[n.NoOne=0]="NoOne",n[n.Admins=1]="Admins",n[n.Partner=3]="Partner",n[n.Everyone=7]="Everyone";var i=function(){function e(e){this.state=e}return e.prototype.get=function(e,t){switch(t){case"date":var n=r.$util.mergeDatesStr(this.state[e],this.p(e));return n.isValid()||(n=null),n;case"localize":return r.$util.localize(this.state,e)||r.$util.localize(this.p(),e);default:return null!=this.state[e]?this.state[e]:this.p(e)}},e.prototype.p=function(e){var t=this.parent();return t&&t.state?e?t.state[e]:t.state:null},e.prototype.eventId=function(){return this.state.eventId},e.prototype.parentId=function(){return this.state.parentId},e.prototype.parent=function(){return r.$data.eventMap.Get(this.state.parentId)},e.prototype.seriesId=function(){return this.parentId()||this.eventId()},e.prototype.series=function(){return r.$data.eventMap.Get(this.seriesId())||this},e.prototype.isSeries=function(){return this.seriesId()==this.eventId()},e.prototype.from=function(){return this.get("from","date")},e.prototype.to=function(){return this.get("to","date")},e.prototype.typeId=function(){return this.get("type")},e.prototype.type=function(){return r.MTBEventTypes[this.typeId()]},e.prototype.status=function(){return this.get("status")},e.prototype.name=function(){return this.get("name","localize")},e.prototype.name_de=function(){return this.get("name")},e.prototype.name_en=function(){return this.get("name_en")},e.prototype.shortDescription=function(){return this.get("shortDescription","localize")},e.prototype.shortDescription_de=function(){return this.get("shortDescription")},e.prototype.shortDescription_en=function(){return this.get("shortDescription_en")},e.prototype.description=function(){return this.get("description","localize")},e.prototype.description_de=function(){return this.get("description")},e.prototype.description_en=function(){return this.get("description_en")},e.prototype.requirements=function(){return this.get("requirements","localize")},e.prototype.requirements_de=function(){return this.get("requirements")},e.prototype.requirements_en=function(){return this.get("requirements_en")},e.prototype.price=function(){return this.get("price")},e.prototype.priceText=function(){return this.isErlebniscard()?r.$res.events.erlebniscardPrice:this.priceAsNr()+" EUR"},e.prototype.priceAsNr=function(){return parseFloat(this.price())},e.prototype.isErlebniscard=function(){return this.price()===e.ErlebniscardPrice},e.prototype.level=function(){return this.get("level")},e.prototype.levelName=function(){return r.MTBLevel[this.level()]},e.prototype.levelDescription=function(){return r.$res.level[this.levelName()]},e.prototype.img=function(e){void 0===e&&(e=!0);var t=this.get("img");return t?"data:"==t.substr(0,5)?t:e?r.$cfg.root+r.$res.events.imgPath+t:t:null},e.prototype.meetingPoint=function(){return this.get("meeting")||e.DefaultMeetingPoint},e.prototype.lat=function(){return parseFloat(this.meetingPoint().split("/")[0])||46.57305526},e.prototype.lng=function(){return parseFloat(this.meetingPoint().split("/")[1])||13.93681599},e.prototype.meetingPointDescription=function(){return this.meetingPoint().split("/")[2]||"Parkplatz Natur Aktiv Park, Faak am See"},e.prototype.maxParticipants=function(){return this.get("max_participants")||0},e.prototype.allowReg=function(){return this.get("allow_reg")||0},e.prototype.isRegAllowed=function(){if(!r.$cfg.allow_reg)return!1;switch(this.allowReg()){case t.Admins:return r.$ctx.session.isAdmin();case t.Partner:return r.$ctx.session.isPartner()||r.$ctx.session.isAdmin();case t.Everyone:return!0}return!1},e.prototype.occurrences=function(){var t=this.seriesId();return $q(r.$data.events).Where(function(e){return e.seriesId()==t&&e.isOccurrence()}).ToArray()},e.prototype.isOccurrence=function(){return null!=this.from()&&null!=this.to()},e.ErlebniscardPrice="Erlebniscard",e.DefaultMeetingPoint="46.57305526/13.93681599/Parkplatz Natur Aktiv Park, Faak am See",e}();r.MTBEvent=i}($alpbros||($alpbros={})),function(e){var t;(t=e.MTBRegistrationStatus||(e.MTBRegistrationStatus={}))[t.Canceled=0]="Canceled",t[t.Active=1]="Active"}($alpbros||($alpbros={})),function(n){!function(t){function r(e){e?n.$doc.bind("data-change",e):n.$doc.trigger("data-change")}function i(){t.eventMap=$q(t.events).ToDictionary(function(e){return e.state.eventId},function(e){return e})}t.init=function(){return n.$doc.hasClass("no-data")?(t.waitEvents=$.Deferred().resolve().promise(),$.Deferred().resolve().promise()):$.when((t.waitEvents=n.$ctx.db.event.q().orderBy("from asc").find()).then(function(e){t.events=e,i()}))},t.change=r,t.addEvent=function(e){Array.isArray(e)||(e=[e]),t.events=$q(t.events).Concat(e).OrderBy(function(e){return e.from()}).ToArray(),i(),r()},t.deleteEvent=function(e){var n=Array.isArray(e)?e:[e];t.events=$q(t.events).Where(function(t){return!$q(n).Any(function(e){return e.eventId()==t.eventId()})}).ToArray(),i(),r()}}(n.$data||(n.$data={}))}($alpbros||($alpbros={})),function(s){var e;(function(e){var t,n=300,r=0,i=$("#loader");function a(){t||(r++,s.$body.addClass("is-loading"),t=setTimeout(function(){i.addClass("show")},n))}function o(){0<(r=Math.max(0,r-1))||(t&&(clearTimeout(t),t=null),i.removeClass("show"),s.$body.removeClass("is-loading"))}e.show=a,e.hide=o,e.toggle=function(e){null==e&&(e=!i.hasClass("show")),e?a():o()}})((e=s.$ui||(s.$ui={})).loader||(e.loader={}))}($alpbros||($alpbros={})),function(a){var o;((o=a.$ui||(a.$ui={})).section||(o.section={})).init=function(e,t){var n=(e?a.$util.getPage(e):null)||a.$pages.get("main"),i=[],r=o.scrollex.init($((e?"":".page ")+"> section, section > section",e),{enter:t&&t.setHashOnScroll?function(e,t){if(a.$body.hasClass("is-loading"))return!1;var n=t.attr("href");n&&(-1==i.indexOf(n)&&i.push(n),1==i.length&&a.$app.setHash(i[0]))}:null,leave:t&&t.setHashOnScroll?function(e,t){if(a.$body.hasClass("is-loading"))return!1;var n=t.attr("href");if(n){var r=i.indexOf(n);-1<r&&(i.splice(r,1),1==i.length&&a.$app.setHash(i[0]))}}:null});n.pageCnt.on("pageload",function(){r.options.enabled=!0}),n.pageCnt.on("pagehide",function(){r.options.enabled=!1})}}($alpbros||($alpbros={})),function(r){var e;((e=r.$ui||(r.$ui={})).link||(e.link={})).init=function(e){$("a",e).each(function(){var n,e;n=$(this),(e=n.attr("href"))?"#"==e[0]&&n.off("click.href").on("click.href",function(e){e&&e.preventDefault();var t=n.attr("href");t&&(t=t.format(r.$url.args)),r.$app.hashChange(t,n.attr("anchor"),n.attr("speed"))}):n.off("click.href").on("click.href",function(e){return e.preventDefault(),!1})})}}($alpbros||($alpbros={})),function(e){var t;((t=e.$ui||(e.$ui={})).img||(t.img={})).init=function(e){Modernizr.svgasimg||$("img.svg",e).each(function(e,t){var n,r,i=$(t);i.hasClass("svg")&&(r=(n=i).attr("src"),n.attr("src",r.replace(".svg",".png")))})}}($alpbros||($alpbros={})),function(e){var t;((t=e.$ui||(e.$ui={})).items||(t.items={})).init=function(e){t.scrollex.init($(".items",e),{delay:void 0}).context.children().wrapInner('<div class="inner"></div>')}}($alpbros||($alpbros={})),function(i){var e;((e=i.$ui||(i.$ui={})).events||(e.events={})).init=function(e){i.$data.waitEvents.done(function(){$(".event-table table",e).each(function(e,t){var n,r;n=$(t),r=moment(new Date),$("tr.dummy",n).remove(),n.prepend($q(i.$data.events).Where(function(e){return e.isOccurrence()&&e.status()==i.MTBEventStatus.TakesPlace}).SkipWhile(function(e){return e.from()<r}).Take(i.$cfg.shownEvents).Select(function(e){return t=e,n=i.$res.events.eventUrl.format(t.eventId()),$("<tr>").addClass("event").append($("<td>").text(t.from().format(i.$res.upcoming.dateFormat))).append($("<td>").append($("<a>").attr("href",n).text(t.name()))).append($("<td>").text(t.priceText()));var t,n}).ToArray())})})}}($alpbros||($alpbros={})),function(s){var t;((t=s.$ui||(s.$ui={})).gallery||(t.gallery={})).init=function(e){t.scrollex.init($(".gallery",e).wrapInner('<div class="inner"></div>').each(function(e,t){var n=$(t),r=parseInt(n.attr("large")),i=parseInt(n.attr("medium")),a=parseInt(n.attr("small")),o=parseInt(n.attr("xsmall")),s=parseInt(n.attr("xxsmall"));$("article",t).each(function(e,t){r<=e&&$(t).addClass("hide-lt-xlarge"),i<=e&&$(t).addClass("hide-lt-large"),a<=e&&$(t).addClass("hide-lt-medium"),o<=e&&$(t).addClass("hide-lt-small"),s<=e&&$(t).addClass("hide-lt-xsmall")})}).prepend(skel.vars.mobile?"":'<div class="forward"></div><div class="backward"></div>'),{delay:50}).context.children(".inner").css("overflow-y",skel.vars.mobile?"visible":"hidden").css("overflow-x",skel.vars.mobile?"scroll":"hidden").scrollLeft(0),$(".gallery.lightbox",e).on("click","a",function(e){var t=$(this),n=t.parents(".gallery"),r=n.children(".modal"),i=r.find("img"),a=t.attr("href");if(!t.hasClass("next")&&!t.hasClass("prev")){var o=a.split("?")[0];o&&o.match(/\.(jpg|gif|png|mp4)$/)&&(e.preventDefault(),e.stopPropagation(),r[0]._locked||(r[0]._locked=!0,r.data("cur",t),i.attr("src",a),n.addClass("modal"),r.addClass("visible"),r.focus(),s.$main.addClass("no-scroll"),setTimeout(function(){r[0]._locked=!1},300)))}}).on("click",".modal",function(e){var t=$(this),n=t.find("img"),r=t.parent();t[0]._locked||t.hasClass("visible")&&(t[0]._locked=!0,t.removeClass("loaded"),setTimeout(function(){r.removeClass("modal"),t.removeClass("visible"),s.$main.removeClass("no-scroll"),setTimeout(function(){n.attr("src",""),t[0]._locked=!1,t.removeData("cur"),s.$body.focus()},175)},125))}).on("click",".prev",function(e){var t=$(this).parents(".gallery").children(".modal"),n=t.data("cur");if(n){var r=n.parent().prev().find("a");r&&r.length||(r=n.parent().parent().children().last().find("a")),r&&r.length&&r.trigger("click")}}).on("click",".next",function(e){var t=$(this).parents(".gallery").children(".modal"),n=t.data("cur");if(n){var r=n.parent().next().find("a");r&&r.length||(r=n.parent().parent().children().first().find("a")),r&&r.length&&r.trigger("click")}}).on("keydown",".modal",function(e){var t=$(this);switch(e.keyCode){case 27:t.trigger("click");break;case 37:t.parent().find(".prev").trigger("click");break;case 39:t.parent().find(".next").trigger("click")}}).prepend('<div class="modal" tabIndex="-1"><a class="prev icon style2 fa-angle-left"></a><div class="inner"><img src="" /></div><a class="next icon style2 fa-angle-right"></a></div>').find("img").on("load",function(e){var t=$(this),n=t.parents(".modal");setTimeout(function(){n.hasClass("visible")&&n.addClass("loaded")},275)})}}($alpbros||($alpbros={})),function(t){var o;((o=t.$ui||(t.$ui={})).instagallery||(o.instagallery={})).init=function(e){$(".instagallery",e).q().ForEach(function(e){return n=e,r=$("<div>").addClass("gallery "+n[0].className.replace("instagallery","")).attr("amount",n.attr("amount")).attr("large",n.attr("large")).attr("medium",n.attr("medium")).attr("small",n.attr("small")).attr("xsmall",n.attr("xsmall")).appendTo(n),i=parseInt(n.attr("amount")),a=n.attr("type").split(" "),n[0].className="instagallery",n.removeAttr("amount"),n.removeAttr("large"),n.removeAttr("medium"),n.removeAttr("small"),n.removeAttr("xsmall"),void t.$ctx.getInstaEntries().then(function(e){var t=$q(e).OrderByDescending(function(e){return e.created_time}).Where(function(e){return-1<a.indexOf(e.type)}).Take(i);t.ForEach(function(e){var t;r.append('<article><a href="'+(t=e).images.standard_resolution.url+'" class="image"><img src="'+t.images.standard_resolution.url+'" alt="" /></a><div class="caption"><h3></h3></div></article>')}),o.gallery.init(n)});var n,r,i,a})}}($alpbros||($alpbros={})),function(e){var n;(function(o){var s,l="AIzaSyBdO_cpM267sMdq2GO-ujjfch3dMjUHMjY",c=0,u=$.Deferred();function p(r,e){u.resolve();var i=new google.maps.Map(r.element[0],{center:r.start?{lat:r.start.lat,lng:r.start.lng}:null,zoom:r.zoom,styles:n.mapStyle});r.element.data("gmap",i);var t,a=[];$q(r.marker).ForEach(function(e,t){var n=new google.maps.Marker({position:new google.maps.LatLng(e.position.lat,e.position.lng),title:e.title,draggable:e.draggable});n.setMap(i),a.push(n),r.element.attr("m"+t+"_lat",e.position.lat),r.element.attr("m"+t+"_lng",e.position.lng),e.draggable&&n.addListener("drag",function(){var e=n.getPosition();r.element.attr("m"+t+"_lat",e.lat),r.element.attr("m"+t+"_lng",e.lng)})}),r.element.data("gmap_markers",a),r.element.mouseenter(function(){t||(t=r.element.children().first()).mouseleave(function(){t.addClass("no-pointer-events")}),t.addClass("no-pointer-events")}),r.element.click(function(){t.removeClass("no-pointer-events")}),r.wait.resolve()}o.maps=[],o.init=function(e){$(".map",e).q().ForEach(function(e){return o.maps.push((n={element:t=e,wait:$.Deferred()},r=parseFloat(t.attr("lat")),i=parseFloat(t.attr("lng")),a=parseFloat(t.attr("zoom")),r&&i&&(n.start={lat:r,lng:i}),a&&(n.zoom=a),n.element.data("gmap_promise",n.wait.promise()),n.marker=$q($(".marker",t)).Select(function(e){return{position:{lat:parseFloat(e.attr("lat")),lng:parseFloat(e.attr("lng"))},title:e.text(),draggable:e.hasClass("draggable")}}).ToArray(),window["initMap"+c]=function(){p(n)},s?u.done(function(){p(n)}):(t.after('<script async defer src="https://maps.googleapis.com/maps/api/js?key='+l+"&callback=initMap"+c+'"><\/script>'),s=!0),c++,n));var t,n,r,i,a})}})((n=e.$ui||(e.$ui={})).map||(n.map={}))}($alpbros||($alpbros={})),function(e){(e.$ui||(e.$ui={})).mapStyle=[{stylers:[{saturation:-100},{gamma:1}]},{elementType:"labels.text.stroke",stylers:[{visibility:"off"}]},{featureType:"poi.business",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"poi.business",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"poi.place_of_worship",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"poi.place_of_worship",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"geometry",stylers:[{visibility:"simplified"}]},{featureType:"water",stylers:[{visibility:"on"},{saturation:50},{gamma:0},{hue:"#50a5d1"}]},{featureType:"administrative.neighborhood",elementType:"labels.text.fill",stylers:[{color:"#333333"}]},{featureType:"road.local",elementType:"labels.text",stylers:[{weight:.5},{color:"#333333"}]},{featureType:"transit.station",elementType:"labels.icon",stylers:[{gamma:1},{saturation:50}]}]}($alpbros||($alpbros={})),function(a){var o;(function(e){var t=$("#menu-btn"),n=$("#menu");function r(){t.addClass("fa-close").removeClass("fa-bars"),a.$main.addClass("menu-opened").addClass("no-scroll"),n.addClass("opened")}function i(){t.addClass("fa-bars").removeClass("fa-close"),a.$main.removeClass("menu-opened").removeClass("no-scroll"),n.removeClass("opened")}e.init=function(){o.link.init(n),t.click(function(){a.$main.hasClass("menu-opened")?i():r()}),n.click(function(e){var t=$(e.target);("menu"==t.attr("id")||t.hasClass("icon"))&&i()})},e.open=r,e.close=i})((o=a.$ui||(a.$ui={})).menu||(o.menu={}))}($alpbros||($alpbros={})),function(i){!function(n){$.fn.timeline=function(){return this.data("timeline")},(n.timeline||(n.timeline={})).init=function(e){$(".timeline",e).each(function(e,t){new r($(t))})};var r=function(){function t(e){this.element=e.data("timeline",this),this.page=i.$util.getPage(this.element),this.initBlocks(),this.initScrolling(),n.link.init(e)}return t.prototype.initScrolling=function(){var e=this;this.hideBlocks(),i.$window.on("scroll",function(){e&&e.hasBlocks()&&e.pageIsActive()&&(window.requestAnimationFrame?window.requestAnimationFrame(function(){e.showBlocks()}):setTimeout(function(){e.showBlocks()},100))})},t.prototype.hasBlocks=function(){return this.blocks&&0<this.blocks.length},t.prototype.pageIsActive=function(){return this.page&&this.page.pageCnt.hasClass("current")},t.prototype.initBlocks=function(){this.blocks=$(".timeline-block",this.element)},t.prototype.hideBlocks=function(){var n=this;this.blocks.each(function(e,t){n.hideBlock($(t))})},t.prototype.showBlocks=function(){var n=this;this.blocks.each(function(e,t){n.showBlock($(t))})},t.prototype.refreshBlocks=function(){var r=this;this.blocks.each(function(e,t){var n=$(t);r.hideBlock(n),r.showBlock(n)})},t.prototype.hideBlock=function(e){e.offset().top>i.$window.scrollTop()+i.$window.height()*t.offset&&e.find(".timeline-img, .timeline-content").addClass("is-hidden")},t.prototype.showBlock=function(e){e.offset().top<=i.$window.scrollTop()+i.$window.height()*t.offset&&e.find(".timeline-img").hasClass("is-hidden")&&e.find(".timeline-img, .timeline-content").removeClass("is-hidden").addClass("bounce-in")},t.offset=.8,t}();n.Timeline=r}(i.$ui||(i.$ui={}))}($alpbros||($alpbros={})),function(e){var t;(function(e){e.init=function(e,t){return new n(e,t)};var n=function(){function l(e,t){var n=this;this.context=e,this.context.each(function(e,t){$(t).data("scrollex",n)});var r=this,i=t.initialize,a=t.terminate,o=t.enter,s=t.leave;this.options=t=$.extend({},l.defaultOptions,t,{initialize:function(){r.initialize($(this),i)},terminate:function(){r.terminate($(this),a)},enter:function(){r.enter($(this),o)},leave:function(){r.leave($(this),s)}}),this.context.scrollex(t)}return l.prototype.initialize=function(e,t){!this.options.enabled||t&&!1===t(this,e)||e.addClass(this.options.inactiveClass)},l.prototype.terminate=function(e,t){!this.options.enabled||t&&!1===t(this,e)||e.removeClass(this.options.inactiveClass)},l.prototype.enter=function(e,t){!this.options.enabled||t&&!1===t(this,e)||e.removeClass(this.options.inactiveClass)},l.prototype.leave=function(e,t){if(this.options.enabled&&(!t||!1!==t(this,e))){var n=this.options;(1==n.bidirectional||n.bidirectional&&e.hasClass(n.bidirectional))&&e.addClass(n.inactiveClass)}},l.defaultOptions={enabled:!0,top:"30vh",bottom:"30vh",inactiveClass:"is-inactive",bidirectional:"onscroll-bidirectional"},l}();e.Scrollex=n})((t=e.$ui||(e.$ui={})).scrollex||(t.scrollex={}))}($alpbros||($alpbros={})),function(c){!function(a){function s(e,t,n,r,i,a){var o;return void 0===n&&(n="top"),void 0===r&&(r="normal"),t&&t.length||(t=e.pageCnt),n||(n=t.attr("anchor")||"top"),r||(r=t.attr("speed")||"normal"),i&&(o=e.remOffset()),null==o&&(o=c.$util.getOffset(t,n)),l(o,n,r,a)}function l(e,t,n,r){if(void 0===t&&(t="top"),void 0===n&&(n="normal"),r||(r=$.Deferred()),"immediate"==n)a.$scrollCnt.stop().scrollTop(e),setTimeout(function(){r.resolve()},100);else{var i=1e3;"slow"==n?i=2e3:"fast"==n&&(i=300),a.$scrollCnt.stop().animate({scrollTop:e},i,"swing",function(){r.resolve()})}return r.promise()}a.$scrollCnt=$("body,html"),a.$backBtn=$("#back-btn"),a.init=function(e,t){n=e,skel.canUse("object-fit")||$(".banner .image, .spotlight .image",n).each(function(e,t){var n=$(t),r=n.children("img"),i=n.parent().attr("class").match(/image-position-([a-z]+)/);switch(n.css("background-image",'url("'+r.attr("src")+'")').css("background-repeat","no-repeat").css("background-size","cover"),1<i.length?i[1]:""){case"left":n.css("background-position","left");break;case"right":n.css("background-position","right");break;case"center":default:n.css("background-position","center")}r.css("opacity","0")}),a.section.init(e,t),a.img.init(e),a.items.init(e),a.events.init(e),a.gallery.init(e),a.instagallery.init(e),a.timeline.init(e),a.map.init(e),a.link.init(e),a.$scrollCnt.trigger("scroll");var n},a.initCommon=function(){var r,e;"ie"==skel.vars.browser&&c.$window.on("resize.flexbox-fix",function(){var e=$(".fullscreen");clearTimeout(t),t=setTimeout(function(){e.prop("scrollHeight")>c.$window.height()?e.css("height","auto"):e.css("height","100vh")},250)}).triggerHandler("resize.flexbox-fix"),a.$backBtn.click(function(e){e&&e.preventDefault(),c.$app.back()}),r=$("#lang-btn"),e=function(e){var t=c.$window.height(),n=c.$window.scrollTop();r.toggleClass("hidden",t/2<n||c.$pages.current&&c.$pages.current.pageCnt.hasClass("no-lang-btn"))},c.$window.scroll(e),c.$window.resize(e),e(),a.menu.init();var t},a.initSkel=function(){skel.breakpoints({xlarge:"(max-width: 1680px)",large:"(max-width: 1280px)",medium:"(max-width: 980px)",small:"(max-width: 736px)",xsmall:"(max-width: 480px)",xxsmall:"(max-width: 360px)",minxlarge:"(min-width: 1680px)",minlarge:"(min-width: 1280px)",minmedium:"(min-width: 980px)",minsmall:"(min-width: 736px)",minxsmall:"(min-width: 480px)",minxxsmall:"(min-width: 360px)"})},a.scrollTo=function(n,r,i,a,o){o||(o=$.Deferred());var e=n.page||"main";return c.$pages.exists(e+"-"+n.dest)&&(e+="-"+n.dest),c.$pages.load(e).done(function(e){var t=n.dest?$("#"+n.dest):null;t&&!t.length&&(t=$("section[href='#/"+n.dest+"']")),s(e,t,r,i,a,o)}).fail(function(e){o.reject(e)}),o.promise()},a.scrollToPage=s,a.scrollToPos=l}(c.$ui||(c.$ui={}))}($alpbros||($alpbros={})),function(i){var a;(function(e){var t=function(){function e(e,t,n,r,i){this.name=e,this.id=t,this.parse=n,this.staticRes=r,this.failLoadStatic=i}return e.prototype.q=function(){return new n(this)},e.prototype.set=function(e,t){var n=this,r=Array.isArray(t)?t:[t];return"post"==e&&this.id&&$q(r).ForEach(function(e){return delete e[n.id]}),a[e]("/"+i.$cfg.ctx.db+"/_table/"+this.name,{resource:r}).then(function(e){return e&&e.resource&&e.resource.length&&$q(e.resource).ForEach(function(e,t){return $.extend(r[t],e)}),Array.isArray(t)?$q(t).Select(function(e){return n.parse(e)}).ToArray():n.parse(t)})},e.prototype.insert=function(e){return this.set("post",e)},e.prototype.update=function(e){return this.set("put",e)},e.prototype.delete=function(e){return this.set("del",e)},e}();e.DBTable=t;var n=function(){function e(e){this._table=e,this._url="/"+i.$cfg.ctx.db+"/_table/"+e.name}return e.prototype.select=function(e){return this._select=e,this},e.prototype.where=function(e){return this._where=e,this},e.prototype.related=function(e){return this._related=e,this},e.prototype.orderBy=function(e){return this._orderBy=e,this},e.prototype.groupBy=function(e){return this._groupBy=e,this},e.prototype.limit=function(e){return this._limit=e,this},e.prototype.offset=function(e){return this._offset=e,this},e.prototype.parseSingle=function(e){return e?this._table.parse?this._table.parse(e):e:null},e.prototype.parseMany=function(e){var t=this;return e&&e.resource?this._table.parse?$q(e.resource).Select(function(e){return t._table.parse(e)}).ToArray():e.resource:[]},e.prototype.get=function(e){var t=this,n={};return this._select&&(n.fields=this._select),a.get(this._url+"/"+e,n).then(function(e){return t.parseSingle(e)})},e.prototype.find=function(){var t=this,e={};return this._select&&(e.fields=this._select),this._where&&(e.filter=this._where),this._orderBy&&(e.order=this._orderBy),this._groupBy&&(e.group=this._groupBy),this._limit&&(e.limit=this._limit),this._offset&&(e.offset=this._offset),this._related&&(e.related=this._related),a.get(this._url,e).then(function(e){return t.parseMany(e)},function(){if(t._table.staticRes)return console.debug("Failed to load "+t._table.name+" from service, try using static resource."),t._table.failLoadStatic&&t._table.failLoadStatic(),t.retryStatic(t._table.staticRes).then(function(e){return t.parseMany(e)})})},e.prototype.retryStatic=function(e){return $.ajax({type:"GET",url:i.$cfg.root+e,accepts:{json:"application/json"},contentType:"application/json"})},e}();e.DBQuery=n,e.event=new t("event","eventId",function(e){return new i.MTBEvent(e)},"data/events.json",function(){i.$cfg.allow_reg=!1})})((a=i.$ctx||(i.$ctx={})).db||(a.db={}))}($alpbros||($alpbros={})),function(s){var l,c;l=s.$ctx||(s.$ctx={}),function(i){var t="alpbros_session",e="alpbros_cookie_agreement";i.current=null,i.profile=null;var a=$.Deferred().resolve();function o(e){return console.debug("set session "+JSON.stringify(e)),i.current=e,i.current?Cookies.set(t,i.current.session_token,{expires:1}):(Cookies.remove(t),i.profile=null),n(),i.current}function n(e){e?s.$doc.bind("session-change",e):s.$doc.trigger("session-change")}i.token=function(){return(i.current?i.current.session_token:null)||Cookies.get(t)},i.wait=function(){return a.promise()},i.signin=function(e,t,n){void 0===n&&(n=0),a||(a=$.Deferred());var r={email:e,password:t};return n?r.duration=n:r.remember_me=!0,console.debug("sign in "+JSON.stringify(r)),l.post("/user/session",r).always(function(){a&&a.resolve()}).then(function(e){return o(e),l.get("/user/profile")}).then(function(e){return c.profile=e,c.current}).fail(function(e,t,n){return o(null)})},i.hashauth=function(e){return a||(a=$.Deferred()),l.post("/hashauth",{hash:e}).always(function(){a&&a.resolve()}).then(function(e){return o(e),l.get("/user/profile")}).then(function(e){return c.profile=e,c.current}).fail(function(e,t,n){return o(null)})},i.signout=function(){return a||(a=$.Deferred()),i.current&&i.current.session_token?(console.debug("sign out"),l.del("/user/session").always(function(){a&&a.resolve()}).then(function(){return o(null)})):(a&&a.resolve(),$.Deferred().resolve().promise())},i.refresh=function(){a||(a=$.Deferred());var e=i.current?i.current.session_token:null;return e||(e=Cookies.get(t)),console.debug("refresh session "+e),e?l.put("/user/session").always(function(){a&&a.resolve()}).then(function(e){return o(e),console.debug("session refreshed "+e.session_token),l.get("/user/profile")}).then(function(e){return c.profile=e,console.debug("got profile for session"),c.current}).fail(function(e,t,n){return o(null)}):(a&&a.resolve(),$.Deferred().reject().promise())},i.granted=function(e){for(var t,n=e.split("/").reverse(),r=s.$cfg.access;r&&n.length;)r=r[n.pop()];return!r||$q(r).Contains((t=(i.current?i.current.role:"")||"",s.$cfg.roles[t]))||$q(r).Contains("*")},i.isPublic=function(){return null==i.current||null==i.current.role||"Alpbrothers WWW"==i.current.role},i.isPartner=function(){return null!=i.current&&"Alpbrothers Partner"==i.current.role},i.isAdmin=function(){return null!=i.current&&"Alpbrothers Admin"==i.current.role},i.hasCookieAgreement=function(){return null!=Cookies.get(e)},i.agreeCookies=function(){Cookies.set(e,"true",{expires:365})},i.change=n}(c=l.session||(l.session={}))}($alpbros||($alpbros={})),function(i){var a;(a=i.$ctx||(i.$ctx={})).getRegistrations=function(e){return a.get("/registration/"+e+"?db="+i.$cfg.ctx.db).then(function(e){return e||(e={}),{registrations:e.registrations,count:e.count||0}})},a.register=function(e,t,n){return a.post("/registration?lang="+i.$cfg.lang+"&db="+i.$cfg.ctx.db,{token:t,reg:e,email:n})},a.deleteRegistration=function(e,t,n,r){return a.del("/registration?lang="+i.$cfg.lang+"&db="+i.$cfg.ctx.db,{reg:e,force:t,status:n||i.MTBRegistrationStatus.Canceled,email:r})}}($alpbros||($alpbros={})),function(e){var t;(t=e.$ctx||(e.$ctx={})).getInstaEntries=function(){return t.get("/insta").then(function(e){return e.data})}}($alpbros||($alpbros={})),function(i){!function(r){function n(e,t,n){return r.session.wait().then(function(){return n&&"GET"!=e&&(n=JSON.stringify(n)),$.ajax({type:e,url:i.$cfg.ctx.baseurl+t,data:n||{},accepts:{json:"application/json"},contentType:"application/json",headers:{"X-DreamFactory-API-Key":i.$cfg.ctx.apikey,"X-DreamFactory-Session-Token":r.session.token()}})})}r.call=n,r.get=function(e,t){return n("GET",e,t)},r.post=function(e,t){return n("POST",e,t)},r.put=function(e,t){return n("PUT",e,t)},r.del=function(e,t){return n("DELETE",e,t)}}(i.$ctx||(i.$ctx={}))}($alpbros||($alpbros={})),function(r){var e,t;e=r.$pages||(r.$pages={}),t=function(){function e(e,t,n){this.name=e,this.pageCnt=t,this.pageCnt.data("page",this),this.pageCnt.hasClass("init-ui")&&(r.$ui.init(this.pageCnt),this.pageCnt.removeClass("init-ui"))}return e.prototype.isCurrent=function(){return this.pageCnt.hasClass("current")},e.prototype.isHidden=function(){return this.pageCnt.hasClass("hidden")},e.prototype.defaultBack=function(){return this.pageCnt.attr("back")},e.prototype.remOffset=function(e){if(null===e)this.pageCnt.removeAttr("offset");else{if(void 0===e){var t=this.pageCnt.attr("offset");return null!=t?parseInt(t):null}this.pageCnt.attr("offset",e)}},e.prototype.load=function(e,t){e&&e.resolve(this)},e}(),e.Page=t}($alpbros||($alpbros={})),function(a){var e,t;e=a.$pages||(a.$pages={}),t=function(i){function e(e,t,n){var r=i.call(this,e,t,n)||this;return a.$ui.initCommon(),a.$ui.init(t,{setHashOnScroll:Modernizr.history}),n.resolve(r),r}return __extends(e,i),e}(e.Page),e.PageMain=t}($alpbros||($alpbros={})),function(l){var e,t;e=l.$pages||(l.$pages={}),t=function(i){function e(e,t,n){var r=i.call(this,e,t,n)||this;return r.timelineCnt=$("#event-timeline"),l.$data.waitEvents.done(function(){r.initTimeline(!0),n.resolve(r)}).fail(function(){n.reject()}),l.$data.change(function(){r.initTimeline(!1)}),r}return __extends(e,i),e.prototype.load=function(e){this.timeline.hasBlocks()||this.timeline.initBlocks(),this.timeline.refreshBlocks(),e.resolve(this)},e.prototype.initForm=function(){var e=this;l.$ui.init($("form",this.pageCnt)),$("input#event-from-date",this.pageCnt).val((new Date).toISOString().substr(0,10));var n=$("select#event-type",this.pageCnt);$q(l.$res.eventTypes).ForEach(function(e){var t=l.MTBEventTypes[e.Key];n.append('<option value="'+t.id+'">'+t.description+"</option>")}),$("input,select",this.pageCnt).change(function(){return e.filterTimeline()})},e.prototype.initTimeline=function(e){this.appendEvents(),l.$ui.init(this.timelineCnt.parent()),e&&this.initForm(),this.timeline=this.timelineCnt.timeline(),this.filterTimeline()},e.prototype.appendEvents=function(){var t=this;this.timelineCnt.empty(),this.timelineItems=$q(l.$data.events).Where(function(e){return e.isOccurrence()&&(e.status()==l.MTBEventStatus.TakesPlace||l.$ctx.session.isAdmin())}).Select(function(e){return{event:e,item:t.getTimelineItem(e)}}).ToArray(),this.timelineCnt.append($q(this.timelineItems).Select(function(e,t){return e.item.toggleClass("even",t%2!=0)}).ToArray())},e.prototype.filterTimeline=function(){var e,r=(e=$("#event-from-date").val())?moment(e):null,i=(e=$("#event-to-date").val())?moment(e):null,a=$("#event-type").val(),o=l.MTBLevel.Everyone|($("#event-level-beginner").is(":checked")?l.MTBLevel.Beginner:l.MTBLevel.Everyone)|($("#event-level-advanced").is(":checked")?l.MTBLevel.Advanced:l.MTBLevel.Everyone),s=0;$q(this.timelineItems).ForEach(function(e){var t=e.event,n=r&&t.from()<r||i&&t.to()>i||a&&"all"!=a&&t.typeId()!=a||o<l.MTBLevel.All&&t.level()!=l.MTBLevel.Everyone&&0==(t.level()&o);e.item.toggleClass("hidden",n),n||(e.item.toggleClass("even",s%2!=0).toggleClass("first-child",0==s),s++)}),this.timeline.refreshBlocks()},e.prototype.getTimelineItem=function(e){var t=e.priceText(),n=l.$res.events.eventUrl.format(e.eventId()),r="#/cmd/edit-event?id="+e.eventId();return $('<div class="timeline-block" eventId="'+e.eventId()+'"><div class="timeline-img bg-color-'+this.getLevelColor(e)+'" title="'+e.type().name+'"><span class="icon style2 major '+e.type().icon+'"></span></div><div class="timeline-content"><h3>'+e.name()+'<br /><code><span class="icon fa-money"></span> '+t+'</code></h3><p><img src="'+e.img()+'" /><strong>'+l.$util.formatFromTo(e.from(),e.to(),l.$res.events.dateFormat,l.$res.events.multiDayFormat)+"<br />"+l.$res.events.level+": "+l.$res.level[l.MTBLevel[e.level()]]+"</strong><br /><br />"+e.shortDescription()+'</p><br style="clear: both;" /><a href="'+n+'" class="button special icon fa-pencil">'+l.$res.events.details+'</a> <a href="'+r+'" class="button icon fa-pencil role-admin">'+l.$res.events.edit+'</a><span class="date">'+l.$util.formatDate(e.from(),l.$res.events.fromFormat)+"</span></div></div>").data("event",e)},e.prototype.getLevelColor=function(e){switch(e.level()){case l.MTBLevel.Beginner:return"green";case l.MTBLevel.Advanced:return"orange";default:return"blue"}},e}(e.Page),e.PageEvents=t}($alpbros||($alpbros={})),function(c){var e,t;e=c.$pages||(c.$pages={}),t=function(i){function e(e,t,n){var r=i.call(this,e,t,n)||this;return c.$data.waitEvents.done(function(){c.$ui.init(t),$("#reg-submit").click(function(e){e.preventDefault();var t=r.validateReg();t&&(c.$ui.loader.show(),grecaptcha.reset(),r.recaptcha=$.Deferred(),r.recaptcha.done(function(e){r.submitReg(e,t)}),grecaptcha.execute())}),$(".map",r.pageCnt).data("gmap_promise").done(function(){r.mapMarker=$(".map",r.pageCnt).data("gmap_markers")[0],n.resolve(r)})}),r}return __extends(e,i),e.prototype.load=function(t){var n=this,e=parseInt(c.$url.args.id);if(e){var r=this.event=c.$data.eventMap.Get(e);r?c.$ctx.getRegistrations(e).done(function(e){n.registrations=e.registrations,n.regcount=e.count||0,n.initUI(r),t&&t.resolve(n)}):t&&t.reject("Event not found for '"+c.$url.hash+"'!")}else t&&t.reject("Missing eventId and/or date!")},e.prototype.initUI=function(e){this.initDetails(e),this.initRegForm(e)},e.prototype.initDetails=function(e){var t=this,n=c.$res.event.details,r=function(e){return $(".event-"+e,t.pageCnt)};r("name").text(e.name()),r("description").html(c.$util.formatMd(e.description())),r("img").attr("src",e.img());var i=c.$util.formatFromTo(e.from(),e.to(),c.$res.event.details.dateFormat);r("date").html(n.date.format(i)),r("level").html(n.level.format(e.levelDescription()));var a=e.from().format(n.meetingTimeFormat);r("meeting").html(n.meeting.format(a,e.meetingPointDescription())),r("participants").html(n.participants.format(e.maxParticipants()));var o=e.isErlebniscard()?n.erlebniscardPrice:n.price.format(e.priceAsNr());r("price").html(o),this.mapMarker.setPosition(new google.maps.LatLng(e.lat(),e.lng())),this.pageCnt.toggleClass("erlebniscard",e.isErlebniscard()),this.pageCnt.toggleClass("allow-reg",e.isRegAllowed()),this.setRequirements(e)},e.prototype.setRequirements=function(e){var t=[],n=$q((e.requirements()||"").split("\n")).Select(function(e){return e.trim()}).ToArray(),r="!"!=n[0],i=$q(n).FirstOrDefault(null,function(e){return"*"!=e[0]&&"!"!=e})||c.$res.requirements[e.type().name].text,a=$q(n).Where(function(e){return"*"==e[0]&&"!"!=e}).ToArray();if(r)for(var o=0;;){var s=c.$res.requirements[e.type().name][o.toString()];if(!s)break;t.push(s),o++}t=t.concat(a),$(".event-requirements-text",this.pageCnt).html(c.$util.formatMd(i)),$(".event-requirements",this.pageCnt).empty().append($q(t).Select(function(e){return $("<li>"+c.$util.formatMd(c.$util.trimStart(e,"*").trim())+"</li>")}).ToArray())},e.prototype.initRegForm=function(e){var n=this,t=$("#reg-remaining",this.pageCnt),r=Math.max(0,e.maxParticipants()-this.regcount);if(t.text(r),this.pageCnt.toggleClass("regs-remaining",0<r),c.$ctx.session.isPartner()){var i=c.$ctx.session.profile;$("#reg-email",this.pageCnt).val(i.email),$("#reg-phone",this.pageCnt).val(i.phone),$("#reg-accommodation",this.pageCnt).val(i.name)}this.pageCnt.toggleClass("see-regs",null!=this.registrations),$("section.registrations table tbody",this.pageCnt).empty().append($q(this.registrations).Select(function(e,t){return n.getRegRow(e,t)}).ToArray())},e.prototype.getRegRow=function(t,e){var n=this,r=c.$res.event.details,i=c.$ctx.session.isAdmin()||c.$ctx.session.isPartner()&&t.createdBy===c.$ctx.session.current.email,a=e+1<=this.event.maxParticipants(),o=t.status==c.MTBRegistrationStatus.Active,s=o?c.MTBRegistrationStatus.Canceled:c.MTBRegistrationStatus.Active,l=o?"cancel":"reactivate";return $("<tr>").toggleClass("error",!a).toggleClass("canceled",!o).append($("<td>").text(moment(t.created).format(r.regDateFormat)).attr("title",r.regBy.format(t.createdBy)),$("<td>").text(t.name),$("<td>").text(t.email),$("<td>").text(t.phone),$("<td>").text(t.age||"***"),$("<td>").text(t.accommodation),$("<td>").append($("<a>").addClass("icon style2 "+(o?"fa-close":"fa-check role-admin")).attr("title",r[l+"Reg"]).toggleClass("disabled",!i).click(function(){c.$cmd.exec("delete-registration",$.extend({},t,{force:!1,status:s})).done(function(){(t.status=s)==c.MTBRegistrationStatus.Canceled?n.regcount--:n.regcount++,n.initRegForm(n.event)})}),$("<a>").addClass("icon style2 fa-trash role-admin").attr("title",r.deleteReg).toggleClass("disabled",!i).click(function(){c.$cmd.exec("delete-registration",$.extend({},t,{force:!0})).done(function(){n.registrations=$q(n.registrations).Where(function(e){return e.regId!=t.regId}).ToArray(),n.regcount--,n.initRegForm(n.event)})})))},e.prototype.getReg=function(){var t=this,e={},n=function(e){return $("#reg-"+e,t.pageCnt).val().trim()||null};return e.eventId=this.event.eventId(),e.name=n("name"),e.email=n("email"),e.phone=n("phone"),e.age=parseInt(n("age"))||0,e.accommodation=n("accommodation"),e.status=c.MTBRegistrationStatus.Active,e},e.prototype.validateReg=function(){var t=this,n=this.getReg(),e=function(e){return $("#reg-"+e,t.pageCnt).toggleClass("error",null==n[e])};e("name"),e("email"),e("phone");var r=$("#reg-agreement",this.pageCnt),i=r.is(":checked");return r.toggleClass("error",!i),0<$("input.error",this.pageCnt).length?null:n},e.prototype.submitReg=function(e,t){var n=this,r={template:"registration_"+c.$cfg.lang,to:[{name:t.name,email:t.email}],bcc:c.$cfg.email.bcc||[],location_origin:location.origin},i=c.$ctx.session.current;i&&i.email&&!$q(r.bcc).Any(function(e){return e.email==i.email})&&r.bcc.push({name:i.first_name+" "+i.last_name,email:i.email}),c.$ctx.register(t,e,r).always(function(){return c.$ui.loader.hide()}).done(function(e){n.registrations&&n.registrations.push(e),n.regcount++,n.initUI(n.event),n.setRegMsg(c.$res.event.details.regSuccess,!1)}).fail(function(e){n.setRegMsg(c.$res.event.details.regFail,!0)})},e.prototype.setRegMsg=function(e,t){$("p.msg",this.pageCnt).toggleClass("error",t).toggleClass("success",!t).text(e)},e}(e.Page),e.PageEvent=t}($alpbros||($alpbros={})),function(l){var e,t;e=l.$pages||(l.$pages={}),t=function(a){function e(e,t,n){var r=a.call(this,e,t,n)||this,i=r;return $q(["type","level","name-de","name-en","short-descr-de","short-descr-en","descr-de","descr-en","requirements-de","requirements-en","from","to"]).ForEach(function(e){r[e.replace(/-/g,"_")]=r.input(e)}),r.img=$(".event-img",t).click(function(){$(".event-img.selected",t).removeClass("selected"),$(this).addClass("selected")}),r.input("from").change(function(){i.copyFromDate($(this))}),r.datesTbl=$("table.dates",t),$("a.add-date",r.datesTbl).click(function(){return r.addDate()}),$("a.button.save",r.pageCnt).click(function(){r.save()}),l.$ui.init(t),$(".map",r.pageCnt).data("gmap_promise").done(function(){r.mapMarker=$(".map",r.pageCnt).data("gmap_markers")[0],n.resolve(r)}),r}return __extends(e,a),e.prototype.load=function(e){if(this.pageCnt.attr("mode",this.mode=l.$url.dest||"edit"),"edit"==this.mode){var t=parseInt(l.$url.args.id);if(null==t||isNaN(t))return e.reject("Missing event id!");if(this.event=l.$data.eventMap.Get(t),!this.event)return e.reject("Missing event "+t)}else this.event=new l.MTBEvent({});this.series=this.event.series(),this.initInputFields(this.event),e&&e.resolve(this)},e.prototype.isSeries=function(){return this.series===this.event},e.prototype.initInputFields=function(e){this.input("name-de").val(e.name_de()),this.input("name-en").val(e.name_en());var t=e.type()||l.MTBEventTypes.TechniqueTraining;this.input("type").val(t.name);var n=e.status()||l.MTBEventStatus.TakesPlace;this.input("status").val(l.MTBEventStatus[n]);var r=e.level();this.input("level","[value="+l.MTBLevel[r]+"]").click(),this.input("price-type","[value="+(e.isErlebniscard()?"erlebniscard":"price")+"]").click(),e.isErlebniscard()||this.input("price").val(parseInt(e.price())),this.input("max-participants").val(e.maxParticipants()||("add"==this.mode?6:0)),this.input("allow-reg").val(e.allowReg().toString()),this.input("short-descr-de").val(e.shortDescription_de()),this.input("short-descr-en").val(e.shortDescription_en()),this.input("descr-de").val(e.description_de()),this.input("descr-en").val(e.description_en()),this.input("requirements-de").val(e.requirements_de()),this.input("requirements-en").val(e.requirements_en());var i=e.img(!1);$(".event-img"+(i?"[value='"+i+"']":".first"),this.pageCnt).click(),this.input("meeting-point-description").val(e.meetingPointDescription());var a=new google.maps.LatLng(e.lat(),e.lng());this.mapMarker.setPosition(a);var o=e.from();o&&this.input("from").val(o.format("YYYY-MM-DDTHH:mm"));var s=e.to();s&&this.input("to").val(s.format("YYYY-MM-DDTHH:mm")),this.occurrences=e.occurrences(),$("table.dates tbody",this.pageCnt).toggle(this.isSeries()),$(".add-date",this.pageCnt).toggle(this.isSeries()),$(".button.edit-series",this.pageCnt).attr("href","#/event/edit?id="+e.parentId()).toggle(null!=e.parentId()),$(".button.delete",this.pageCnt).click(function(){l.$cmd.exec("delete-event",{id:e.eventId()}).done(function(){l.$app.hashChange("#/events")})}),this.refreshDatesTbl()},e.prototype.addDate=function(){var t=moment(this.from.val()),n=moment(this.to.val());if(!t.isValid())return alert("Invalid from date!");if(!n.isValid())return alert("Invalid to date!");if($q(this.occurrences).Any(function(e){return e.from().isSame(t)&&e.to().isSame(n)&&e.status()!=l.MTBEventStatus.Deleted}))return alert("Duplicate date");var e=$q(this.series.occurrences()).FirstOrDefault(null,function(e){return e.from().isSame(t)&&e.to().isSame(n)});e&&(e.state.status=l.MTBEventStatus.TakesPlace),this.occurrences.push(e||new l.MTBEvent({from:t.toISOString(),to:n.toISOString()})),this.refreshDatesTbl()},e.prototype.refreshDatesTbl=function(){var t=this;this.occurrences=$q(this.occurrences).Distinct(function(e){return e.from().toISOString()+"-"+e.to().toISOString()}).ToArray();var n=$("tbody",this.datesTbl).empty();$q(this.occurrences).OrderBy(function(e){return e.from()}).ForEach(function(e){e.status()!=l.MTBEventStatus.Deleted&&n.append(t.getDateRow(e))})},e.prototype.getDateRow=function(e){var t=this,n=this;return $("<tr>").data("event",e).append($("<td>").addClass("event-from").text(e.from().format(l.$res.event.edit.dateFormat)).change(function(){n.copyFromDate($(this))}),$("<td>").addClass("event-to").text(e.to().format(l.$res.event.edit.dateFormat)),$("<td>").append($("<a>").addClass("icon style2 fa-repeat").attr("title",l.$res.event.edit.repeat).click(function(){t.from.val(e.from().clone().add(7,"days").format("YYYY-MM-DDTHH:mm")),t.to.val(e.to().clone().add(7,"days").format("YYYY-MM-DDTHH:mm")),t.addDate(),t.refreshDatesTbl()}),$("<a>").addClass("icon style2 fa-pencil mode-edit").click(function(){l.$app.hashChange(l.$res.event.edit.occurrenceUrl.format(e.eventId()))}),$("<a>").addClass("icon style2 fa-minus").click(function(){e.state.status=l.MTBEventStatus.Deleted,t.refreshDatesTbl()})))},e.prototype.copyFromDate=function(e){var t=e.val();if(t){var n=l.MTBEventTypes[this.input("type").val()];e.parent().next().find("input[name=event-to]").val(moment(t).add(n.duration,"hours").format("YYYY-MM-DDTHH:mm"))}},e.prototype.input=function(e,t){return $("[name=event-"+e+"]"+(t||""),this.pageCnt)},e.prototype.getState=function(){return this.isSeries()&&0==this.occurrences.length?null:(this.isSeries()?e=this.series?this.series.state:{parentId:null,from:null,to:null}:((e=this.event.state).from=moment(this.from.val()).format("YYYY-MM-DDTHH:mm"),e.to=moment(this.to.val()).format("YYYY-MM-DDTHH:mm")),e.type=l.MTBEventTypes[this.input("type").val()].id,e.status=l.MTBEventStatus[this.input("status").val()],e.name=this.input("name-de").val(),e.name_en=this.input("name-en").val(),e.shortDescription=this.input("short-descr-de").val(),e.shortDescription_en=this.input("short-descr-en").val(),e.description=this.input("descr-de").val(),e.description_en=this.input("descr-en").val(),e.requirements=this.input("requirements-de").val(),e.requirements_en=this.input("requirements-en").val(),e.price=this.getPrice(),e.max_participants=parseInt(this.input("max-participants").val()),e.allow_reg=parseInt(this.input("allow-reg").val())||0,e.level=l.MTBLevel[this.input("level",":checked").val()],e.img=$(".event-img.selected",this.pageCnt).attr("value"),e.meeting=this.getMeetingPoint(),e);var e},e.prototype.getOccurrences=function(t){return $q(this.occurrences).Select(function(e){return e.state.parentId=t.eventId(),e.state}).ToArray()},e.prototype.getPrice=function(){return"erlebniscard"==this.input("price-type",":checked").val()?l.MTBEvent.ErlebniscardPrice:this.input("price").val()},e.prototype.getMeetingPoint=function(){var e=this.mapMarker.getPosition(),t=this.input("meeting-point-description").val();return e.lat()+"/"+e.lng()+"/"+t},e.prototype.save=function(){var i=this;0==this.occurrences.length&&this.input("from").val()&&this.input("to").val()&&$("a.add-date",this.pageCnt).click();var e=this.getState();l.$ui.loader.show(),l.$ctx.db.event["add"==this.mode?"insert":"update"](e).done(function(n){if(!i.isSeries())return l.$ui.loader.hide(),l.$data.change(),void("add"==i.mode&&l.$app.hashChange("#/event/edit?id="+n.eventId()));var e=i.getOccurrences(n),t=$q(e).Where(function(e){return null==e.eventId||0==e.eventId}).ToArray(),r=$q(e).Where(function(e){return null!=e.eventId}).ToArray();$.when(t.length?l.$ctx.db.event.insert(t):$.Deferred().resolve().promise(),r.length?l.$ctx.db.event.update(r):$.Deferred().resolve().promise()).done(function(e,t){"add"==i.mode&&(e=[n].concat(e)),e&&e.length?l.$data.addEvent(e):l.$data.change(),"add"==i.mode&&l.$app.hashChange("#/event/edit?id="+n.eventId())}).always(function(){l.$ui.loader.hide()})}).fail(function(){l.$ui.loader.hide()})},e}(e.Page),e.PageEventEdit=t}($alpbros||($alpbros={})),function(a){var e,t;e=a.$pages||(a.$pages={}),t=function(i){function e(e,t,n){var r=i.call(this,e,t,n)||this;return a.$ui.init(t),r.signInBtn=$("#signin-btn",t).click(function(e){e&&e.preventDefault(),r.signIn()}),r.email=$("#signin-email",r.pageCnt),r.pwd=$("#signin-pwd",r.pageCnt),r.errorLbl=$("#signin-error",r.pageCnt),n.resolve(r),r}return __extends(e,i),e.prototype.signIn=function(){var r=this;a.$ui.loader.show(),a.$cmd.exec("signin",{email:this.email.val(),pwd:this.pwd.val(),return:a.$url.args?a.$url.args.return:null}).always(function(){a.$ui.loader.hide(),r.email.val(""),r.pwd.val("")}).done(function(){r.errorLbl.addClass("hidden")}).fail(function(e,t,n){r.errorLbl.text(n).removeClass("hidden")})},e}(e.Page),e.PageSignin=t}($alpbros||($alpbros={})),function(a){var e,t;e=a.$pages||(a.$pages={}),t=function(i){function e(e,t,n){var r=i.call(this,e,t,n)||this;return a.$ui.init(t),n.resolve(r),r}return __extends(e,i),e.prototype.load=function(e){var t=a.$ctx.session.current;t&&t.role_id==a.Roles.Admin?e.resolve(this):e.reject({redirect:"#/signin?return=/admin"})},e}(e.Page),e.PageAdmin=t}($alpbros||($alpbros={})),function(n){var e,t;e=n.$pages||(n.$pages={}),t=function(i){function e(e,t,n){var r=i.call(this,e,t,n)||this;return r.title=$("h2.title",r.pageCnt),r.text=$("p.text",r.pageCnt),n.resolve(r),r}return __extends(e,i),e.prototype.load=function(e,t){var i=this;this._result=$.Deferred(),this.result=this._result.promise(),t||(t=n.$url.args),this.title.text(t.title),this.text.text(t.text);var a=$(".actions",this.pageCnt).empty();$q(t.items).ForEach(function(e){var t=e.Key,n=e.Value,r=$("<li>").appendTo(a);$("<a>").addClass("button special").text(n).appendTo(r).click(function(){i._result.resolve(t)})}),a.append($('<li><a href="#poppage" class="button cancel special icon fa-close">'+n.$res.common.cancel+"</a></li>")),n.$ui.link.init(this.pageCnt),e.resolve(this)},e}(e.Page),e.PageChoice=t}($alpbros||($alpbros={})),function(a){var e,t;e=a.$pages||(a.$pages={}),t=function(i){function e(e,t,n){var r=i.call(this,e,t,n)||this;return a.$ui.init(t),r.title=$("h2.title",r.pageCnt),r.text=$("p.text",r.pageCnt),r.okBtn=$(".button.ok",r.pageCnt).click(function(){r._result&&r._result.resolve(!0)}),r.cancelBtn=$(".button.cancel",r.pageCnt).click(function(){r._result&&r._result.resolve(!1)}),n.resolve(r),r}return __extends(e,i),e.prototype.load=function(e,t){t||(t=a.$url.args||{});var n=t.res;n&&((n=a.$util.expandPath(a.$res,n)).title&&(t.title=n.title),n.text&&(t.text=n.text),n.ok&&(t.ok=n.ok),n.cancel&&(t.cancel=n.cancel)),this._result=$.Deferred(),this.result=this._result.promise(),$("h2",this.pageCnt).text((t.title||"").format(t)),$("p",this.pageCnt).text((t.text||"").format(t)),this.okBtn.attr("href",t.ok||"#poppage"),t.cancel&&this.cancelBtn.attr("href",t.cancel),this.cancelBtn.parent().toggle("info"!=t.mode),a.$ui.link.init(this.pageCnt),e.resolve(this)},e}(e.Page),e.PageConfirm=t}($alpbros||($alpbros={})),function(b){!function(d){var f={},h={};function g(t,n,r){var e=b.$cfg.pages[t];if(null==e)return $.Deferred().reject("Missing page "+t).fail(function(e){v(e,t,n)}).promise();if(!b.$ctx.session.granted("page/"+t))return n?$.Deferred().reject("Unauthorized page preload "+t).promise():$.Deferred().reject("Unauthorized page load "+t).fail(function(e){v(e,t,n)}).promise();if(e.synname)return g(e.synname,n);var i,a,o,s,l=f[t];if(!l){var c=$.Deferred().fail(function(e){v(e,t,n)});l=c.promise();var u,p=y(t);if(!(p||(s=(o=t).split("-"),o=$q(s).Select(function(e){return e[0].toUpperCase()+e.substr(1)}).ToArray().join(""),u=d["Page"+o]||d.Page)))return c.reject().promise();p?c.resolve(p):(n||b.$ui.loader.show(),(i=t,a=$("#"+i+".page"),0<a.length?$.Deferred().resolve(a).promise():$.ajax({type:"GET",url:"pages/"+i+".html"}).then(function(e){return e||(e='<div id="'+i+'"></div>'),a=$(e),b.$body.append(a),a})).then(function(e){p=h[t]=new u(t,e,c),u==d.Page&&c.resolve(p)},function(){c.reject()}))}return(f[t]=l.then(function(e){if(!e.load||n)return e;var t=$.Deferred();return e.load(t,r),t}).then(function(e){return m(e,n),b.$ui.loader.hide(),e})).fail(function(e){v(e,t,n)})}function m(e,t,n){d.current||(d.current=e,n||d.stack.push(d.current)),t||(d.current!=e&&(d.current&&(d.current.remOffset(b.$window.scrollTop()),d.current.pageCnt.removeClass("current").addClass("hidden"),d.current.pageCnt.trigger("pagehide")),(d.current=e).pageCnt.addClass("current").removeClass("hidden"),d.current.pageCnt.trigger("pageload"),n||d.stack.push(d.current)),b.$ui.$backBtn.toggleClass("hidden",d.current==y("main")||d.current.pageCnt.hasClass("no-back-btn")))}function v(e,t,n){if(b.$ui.loader.hide(),delete f[t],e&&e.redirect)return b.$app.hashChange(e.redirect);n||b.$app.back(),console.error("Could not load page "+t+"! "+e)}function y(e){return h[e]}d.stack=[],d.load=g,d.preload=function(e){return g(e,!0)},d.back=function(){var e=$.Deferred();if(d.stack.length<2)return e.resolve().promise();d.stack.pop();var t=d.stack[d.stack.length-1];return t||(t=d.get("main")),m(t,!1,!0),b.$ui.scrollToPage(t,void 0,void 0,"immediate",!0,e)},d.get=y,d.exists=function(e){return null!=b.$cfg.pages[e]}}(b.$pages||(b.$pages={}))}($alpbros||($alpbros={})),function(a){var e,t;e=a.$cmd||(a.$cmd={}),t=function(){function e(){}return e.prototype.exec=function(e){var t=e.hash,n=e.email,r=e.pwd;if(!(t||n&&r))return $.Deferred().reject("Missing credentials!").promise();var i=e.return||"#/";return a.$ui.loader.show(),(t?a.$ctx.session.hashauth(t):a.$ctx.session.signin(n,r)).always(function(){a.$ui.loader.hide()}).done(function(e){return a.$app.hashChange(a.$util.ensureStartsWith(i,"#"))}).fail(function(e,t,n){console.error(n)})},e}(),e.CmdSignin=t}($alpbros||($alpbros={})),function(t){var e,n;e=t.$cmd||(t.$cmd={}),n=function(){function e(){}return e.prototype.exec=function(e){return t.$ctx.session.signout().always(function(){t.$app.back()}).done(function(){})},e}(),e.CmdSignout=n}($alpbros||($alpbros={})),function(t){var e,n;e=t.$cmd||(t.$cmd={}),n=function(){function e(){}return e.prototype.exec=function(e){return t.$ctx.session.agreeCookies(),t.$app.setCookieAgreement(!0),t.$app.back(),$.Deferred().resolve().promise()},e}(),e.CmdAgreeCookies=n}($alpbros||($alpbros={})),function(r){var e,t;e=r.$cmd||(r.$cmd={}),t=function(){function e(){}return e.prototype.exec=function(e){var t=parseInt(e.id);if(null==t||isNaN(t))return $.Deferred().reject("Missing id!").promise();var n=r.$data.eventMap.Get(t);return n?r.$app.choice(r.$res.cmdEditEvent).done(function(e){var t="series"==e?n.seriesId():n.eventId();r.$app.hashChange("#/event/edit?id="+t)}):$.Deferred().reject("Missing event with id "+t+"!").promise()},e}(),e.CmdEditEvent=t}($alpbros||($alpbros={})),function(i){var e,t;e=i.$cmd||(i.$cmd={}),t=function(){function e(){}return e.prototype.exec=function(e){var t=parseInt(e.id);if(null==t||isNaN(t))return $.Deferred().reject("Missing id!").promise();var n=i.$data.eventMap.Get(t);if(!n)return $.Deferred().reject("Missing event with id "+t+"!").promise();var r=[n];return n.isSeries()&&(r=n.occurrences().concat(n)),i.$app.confirm(i.$res.cmdDeleteEvent.title,i.$res.cmdDeleteEvent.text,e.ok,e.cancel).done(function(e){return i.$ui.loader.show(),i.$ctx.db.event.delete($q(r).Select(function(e){return e.state}).ToArray()).always(function(){i.$ui.loader.hide()}).done(function(e){return i.$data.deleteEvent(e),e})})},e}(),e.CmdDeleteEvent=t}($alpbros||($alpbros={})),function(s){var e,t;e=s.$cmd||(s.$cmd={}),t=function(){function e(){}return e.prototype.exec=function(t){var n=t;if(!n||!n.regId)return $.Deferred().reject("Missing reg!").promise();"string"==typeof t.force&&(t.force="true"===t.force);var e="";e=t.force?"Delete":t.status==s.MTBRegistrationStatus.Canceled?"Cancel":"Reactivate";var r=s.$res.cmdDeleteReg["title"+e],i=s.$res.cmdDeleteReg["text"+e].format(n.name),a={template:(t.force||"Cancel"==e?"delete_":"")+"registration_"+s.$cfg.lang,to:[{name:n.name,email:n.email}],bcc:s.$cfg.email.bcc||[],location_origin:location.origin},o=s.$ctx.session.current;return o&&o.email&&!$q(a.bcc).Any(function(e){return e.email==o.email})&&a.bcc.push({name:o.first_name+" "+o.last_name,email:o.email}),s.$app.confirm(r,i,t.ok,t.cancel).done(function(e){return s.$ui.loader.show(),s.$ctx.deleteRegistration(n,t.force,t.status,a).always(function(){s.$ui.loader.hide()})})},e}(),e.CmdDeleteRegistration=t}($alpbros||($alpbros={})),function(r){var e,t;e=r.$cmd||(r.$cmd={}),t=function(){function e(){}return e.prototype.exec=function(e){return r.$ctx.get("/system/lookup/"+r.$cfg.instameta_id).always(function(){r.$ui.loader.hide()}).then(function(e){var t=JSON.parse(e.value),n=t.redirectUrl+"?api_key="+r.$cfg.ctx.apikey;window.open("https://api.instagram.com/oauth/authorize/?client_id="+t.clientId+"&redirect_uri="+n+"&response_type=code")}).fail(function(e,t,n){console.error(n)})},e}(),e.CmdInstaAuth=t}($alpbros||($alpbros={})),function(e){!function(a){function t(e,t){var n,r,i=a[(n=e,r=n.split("-"),"Cmd"+(n=$q(r).Select(function(e){return e[0].toUpperCase()+e.substr(1)}).ToArray().join("")))];return i?(new i).exec(t||{}):$.Deferred().reject("Cmd "+e+" not found!").promise()}a.exec=t,a.execUrl=function(e){return e&&"cmd"==e.page&&e.dest?t(e.dest,e.args):$.Deferred().reject("Invalid cmd url '"+(e?e.hash:"")+"'").promise()};var e=function(){function e(){}return e.prototype.exec=function(e){return $.Deferred().resolve().promise()},e}();a.Cmd=e}(e.$cmd||(e.$cmd={}))}($alpbros||($alpbros={})),function(p){p.$window=$(window),p.$doc=$(document.documentElement),p.$body=$(document.body),p.$main=$("#main.page"),function(a){var o=!1,s=!1,l=!1;function t(e,t,n){if("#back"!==e&&"#pophistory"!=e&&"#poppage"!=e){if(o=!0,l||(s=!0),p.$url=p.$util.parseUrl(e||window.location.hash),"cmd"==p.$url.page)return p.$cmd.execUrl(p.$url).fail(function(e){return console.error(e),a.back()});var r=p.$pages.current&&p.$url.page!=p.$pages.current.name;e&&window.location.hash!=e&&(r&&(p.$ui.$backBtn.attr("href",window.location.hash),window.location.hash=e),Modernizr.history&&c(e)),r&&(n="immediate",document.title=function(e){var t=p.$res[e.page],n=e.dest&&t?t[e.dest]:null;{if(n&&n.title)return n.title;if(t&&t.title)return t.title}return p.$res.main.title}(p.$url),l||p.$pages.current.remOffset(p.$window.scrollTop()));var i=p.$url.args;return i&&(i.anchor&&(t=i.anchor),i.speed&&(n=i.speed)),p.$ui.scrollTo(p.$url,t,n,l).fail(function(e){u()}).done(function(){o=s=l=!1})}a.back(e)}function c(e){history.replaceState(e,void 0,e)}function u(e){l=!0,"#back"===e&&(e=null),e||(e=p.$ui.$backBtn.attr("back")||p.$pages.current&&p.$pages.current.defaultBack()||"#/"),"#pophistory"==e?history.back():"#poppage"==e?p.$pages.back().always(function(){l=!1}):t(e).always(function(){l=!1})}function n(e){p.$doc.toggleClass("authenticated",e).toggleClass("unauthenticated",!e).toggleClass("role-public",p.$ctx.session.isPublic()).toggleClass("role-partner",p.$ctx.session.isPartner()).toggleClass("role-admin",p.$ctx.session.isAdmin())}function r(e){p.$doc.toggleClass("missing-cookie-agreement",!e)}function i(e,t,n,r,i){return"string"==typeof e&&(e={title:e,text:t,ok:n,cancel:r}),e.mode=i||"confirm",p.$pages.load("confirm",!1,e).then(function(e){return e.result})}a.init=function(e){p.$cfg.init(e),Modernizr.history&&(history.scrollRestoration="manual",history.length),p.$window.on("hashchange",function(){o||t()}),Modernizr.history&&p.$window.on("popstate",function(){s||(l=!0)}),r(p.$ctx.session.hasCookieAgreement()),p.$ctx.session.change(function(){n(null!=p.$ctx.session.current)}),p.$ctx.session.refresh().always(function(){p.$data.init(),p.$pages.preload("main").done(function(){t(void 0,void 0,"immediate").done(function(){$q(p.$cfg.pages).Where(function(e){return e.Value.preload}).ForEach(function(e){return p.$pages.preload(e.Key)})})})})},a.hashChange=t,a.setHash=c,a.home=function(){t("#/")},a.back=u,a.setAuthenticated=n,a.setCookieAgreement=r,a.confirm=i,a.info=function(e,t,n){return i(e,t,n,"info")},a.choice=function(e,t,n){return"string"==typeof e&&(e={title:e,text:t,items:n}),p.$pages.load("choice",!1,e).then(function(e){return e.result})}}(p.$app||(p.$app={})),p.$ui.initSkel()}($alpbros||($alpbros={}));