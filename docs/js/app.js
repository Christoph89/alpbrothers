"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),$alpbros;!function(e){!function(e){e[e.Partner=2]="Partner",e[e.WWW=3]="WWW",e[e.Admin=4]="Admin"}(e.Roles||(e.Roles={}));!function(e){e[e.Everyone=0]="Everyone",e[e.Beginner=1]="Beginner",e[e.Advanced=2]="Advanced",e[e.All=3]="All"}(e.MTBLevel||(e.MTBLevel={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){function n(e,t){return e.format(t)}function i(e,t,n,i){i&&!r(e,t)&&(n=i);var o=n.split("-");return e.format(o[0].trim())+" - "+t.format(o[1].trim())}function r(e,t){return e.year()==t.year()&&e.month()==t.month()&&e.date()==t.date()}function o(e,t){return e&&e.isValid()?(0==e.hour()&&0==e.minute()&&(e.hour(t.hour()),e.minute(t.minute())),e):t?t.clone():null}function s(e,t){return o(moment(e),moment(t))}function a(e,t){return null==e&&(e=""),e[0]==t?e:t+e}function l(e,t){if(void 0===t&&(t="top"),e="string"==typeof e?$(e):e,0==e.length)return null;var n=e.offset().top;return"middle"==t?n-($(window).height()-e.outerHeight())/2:Math.max(n,0)}function c(t,n){if(!t)return null;n||(n="name");var i=t[n+"_"+e.$cfg.lang];return void 0===i&&(i=t[n]),i}function u(e){for(var t=e;t&&!t.hasClass("page");)t=t.parent();return t.hasClass("page")?t.data("page"):null}function p(t){t=t.replace("#/","").replace("#","");var n={hash:"#/"+t},i=t.split("?"),r=(i[0]||"").split("/");return n.page=r[0],"cmd"==n.page||e.$pages.exists(n.page)?n.dest=r[r.length-1]:(n.dest=n.page,n.page="main"),n.args=f(i[1]),n}function f(e){if(!e)return{};var t={};return $q(e.split("&")).ForEach(function(e){var n=e.split("=");t[n[0]]=n[1]}),t}t.formatDate=n,t.formatFromTo=i,t.dateEquals=r,t.mergeDates=o,t.mergeDatesStr=s,t.ensureStartsWith=a,t.getOffset=l,t.localize=c,t.getPage=u,t.parseUrl=p,t.splitArgs=f,String.prototype.format=function(){var e=this,t=arguments;if(!t||!t.length)return e;1==t.length&&"object"==typeof t[0]&&(t=t[0]);for(var n in t)e=e.replace("{"+n+"}",t[n]);return e}}(e.$util||(e.$util={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){function n(t){$.extend(this,t),e.$res=t.res,i(),r()}function i(){$q(e.MTBEventTypes).ForEach(function(t){return $.extend(t.Value,e.$res.eventTypes[t.Key])}),moment.locale(t.lang)}function r(){$q(t.pages).ForEach(function(e){$q(e.Value.synonyms).ForEach(function(n){t.pages[n]={name:n,preload:!1,synonyms:[],synname:e.Key}})})}t.init=n}(e.$cfg||(e.$cfg={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){e.MTBEventTypes={},e.MTBEventTypes[0]=e.MTBEventTypes.None={id:0,name:"None",description:"@@cfg",icon:"@@cfg",duration:0},e.MTBEventTypes[1]=e.MTBEventTypes.TechniqueTraining={id:1,name:"TechniqueTraining",description:"@@cfg",icon:"@@cfg",duration:3.5},e.MTBEventTypes[2]=e.MTBEventTypes.GuidedTour={id:2,name:"GuidedTour",description:"@@cfg",icon:"@@cfg",duration:4},e.MTBEventTypes[3]=e.MTBEventTypes.EBikeTour={id:3,name:"EBikeTour",description:"@@cfg",icon:"@@cfg",duration:4},e.MTBEventTypes[4]=e.MTBEventTypes.Camp={id:4,name:"Camp",description:"@@cfg",icon:"@@cfg",duration:72},e.MTBEventTypes[5]=e.MTBEventTypes.MechanicalTraining={id:5,name:"MechanicalTraining",description:"@@cfg",icon:"@@cfg",duration:2}}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(e){e[e.TakesPlace=0]="TakesPlace",e[e.InProgress=1]="InProgress",e[e.Canceled=3]="Canceled",e[e.Deleted=3]="Deleted"}(e.MTBEventStatus||(e.MTBEventStatus={}));var t=function(){function t(e){this.state=e}return t.prototype.get=function(t,n){switch(n){case"date":var i=e.$util.mergeDatesStr(this.state[t],this.p(t));return i.isValid()||(i=null),i;case"localize":return e.$util.localize(this.state,t)||e.$util.localize(this.p(),t);default:return null!=this.state[t]?this.state[t]:this.p(t)}},t.prototype.p=function(e){var t=this.parent();return t&&t.state?e?t.state[e]:t.state:null},t.prototype.eventId=function(){return this.state.eventId},t.prototype.parentId=function(){return this.state.parentId},t.prototype.parent=function(){return e.$data.eventMap.Get(this.state.parentId)},t.prototype.seriesId=function(){return this.parentId()||this.eventId()},t.prototype.series=function(){return e.$data.eventMap.Get(this.seriesId())},t.prototype.from=function(){return this.get("from","date")},t.prototype.to=function(){return this.get("to","date")},t.prototype.typeId=function(){return this.get("type")},t.prototype.type=function(){return e.MTBEventTypes[this.typeId()]},t.prototype.status=function(){return this.get("status")},t.prototype.name=function(){return this.get("name","localize")},t.prototype.name_de=function(){return this.get("name")},t.prototype.name_en=function(){return this.get("name_en")},t.prototype.shortDescription=function(){return this.get("shortDescription","localize")},t.prototype.shortDescription_de=function(){return this.get("shortDescription")},t.prototype.shortDescription_en=function(){return this.get("shortDescription_en")},t.prototype.description=function(){return this.get("description","localize")},t.prototype.description_de=function(){return this.get("description")},t.prototype.description_en=function(){return this.get("description_en")},t.prototype.price=function(){return this.get("price")},t.prototype.isErlebniscard=function(){return this.price()===t.ErlebniscardPrice},t.prototype.level=function(){return this.get("level")},t.prototype.img=function(t){void 0===t&&(t=!0);var n=this.get("img");return n?"data:"==n.substr(0,5)?n:t?e.$cfg.root+e.$res.events.imgPath+n:n:null},t.prototype.occurrences=function(){var t=this.seriesId();return $q(e.$data.events).Where(function(e){return e.seriesId()==t&&e.isOccurrence()}).ToArray()},t.prototype.isOccurrence=function(){return null!=this.from()&&null!=this.to()},t.ErlebniscardPrice="Erlebniscard",t}();e.MTBEvent=t}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){function n(){return $.when((t.waitEvents=e.$ctx.db.event.q().orderBy("from asc").find()).then(function(e){t.events=e,r()}))}function i(t){t?e.$doc.bind("data-change",t):e.$doc.trigger("data-change")}function r(){t.eventMap=$q(t.events).ToDictionary(function(e){return e.state.eventId},function(e){return e})}function o(e){Array.isArray(e)||(e=[e]),t.events=$q(t.events).Concat(e).OrderBy(function(e){return e.from()}).ToArray(),r(),i()}t.init=n,t.change=i,t.addEvent=o}(e.$data||(e.$data={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){!function(t){function n(){o||(a++,e.$body.addClass("is-loading"),o=setTimeout(function(){l.addClass("show")},s))}function i(){(a=Math.max(0,a-1))>0||(o&&(clearTimeout(o),o=null),l.removeClass("show"),e.$body.removeClass("is-loading"))}function r(e){void 0==e&&(e=!l.hasClass("show")),e?n():i()}var o,s=300,a=0,l=$("#loader");t.show=n,t.hide=i,t.toggle=r}(t.loader||(t.loader={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){!function(n){function i(n,i){var r=(n?e.$util.getPage(n):null)||e.$pages.get("main"),o=[],s=t.scrollex.init($((n?"":".page ")+"> section, section > section",n),{enter:i&&i.setHashOnScroll?function(t,n){if(e.$body.hasClass("is-loading"))return!1;var i=n.attr("href");i&&(-1==o.indexOf(i)&&o.push(i),1==o.length&&e.$app.setHash(o[0]))}:null,leave:i&&i.setHashOnScroll?function(t,n){if(e.$body.hasClass("is-loading"))return!1;var i=n.attr("href");if(i){var r=o.indexOf(i);r>-1&&(o.splice(r,1),1==o.length&&e.$app.setHash(o[0]))}}:null});r.pageCnt.on("pageload",function(){s.options.enabled=!0}),r.pageCnt.on("pagehide",function(){s.options.enabled=!1})}n.init=i}(t.section||(t.section={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){!function(t){function n(e){$("a",e).each(function(){i($(this))})}function i(t){var n=t.attr("href");n&&"#"==n[0]&&t.off("click.href").on("click.href",function(n){n&&n.preventDefault();var i=t.attr("href");i&&(i=i.format(e.$url.args)),e.$app.hashChange(i,t.attr("anchor"),t.attr("speed"))})}t.init=n}(t.link||(t.link={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(e){!function(e){function t(e){Modernizr.svgasimg||$("img.svg",e).each(function(e,t){var i=$(t);i.hasClass("svg")&&n(i)})}function n(e){var t=e.attr("src");e.attr("src",t.replace(".svg",".png"))}e.init=t}(e.img||(e.img={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(e){!function(t){function n(t){e.scrollex.init($(".items",t),{delay:i}).context.children().wrapInner('<div class="inner"></div>')}var i;t.init=n}(e.items||(e.items={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){!function(t){function n(t){e.$data.waitEvents.done(function(){$(".event-table table",t).each(function(e,t){i($(t))})})}function i(t){$("tr.dummy",t).remove(),t.prepend($q(e.$data.events).Where(function(e){return e.isOccurrence()}).Take(e.$cfg.shownEvents).Select(function(e){return r(e)}).ToArray())}function r(t){return $("<tr>").addClass("event").append($("<td>").text(t.from().format(e.$res.upcoming.dateFormat))).append($("<td>").append($("<a>")).attr("target","_blank").text(t.name())).append($("<td>").text(t.isErlebniscard()?e.$res.events.erlebniscardPrice:t.price()))}t.init=n}(t.events||(t.events={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){!function(n){function i(e){t.scrollex.init($(".gallery",e).wrapInner('<div class="inner"></div>').prepend(skel.vars.mobile?"":'<div class="forward"></div><div class="backward"></div>'),{delay:50}).context.children(".inner").css("overflow-y",skel.vars.mobile?"visible":"hidden").css("overflow-x",skel.vars.mobile?"scroll":"hidden").scrollLeft(0),r(e)}function r(t){$(".gallery.lightbox",t).on("click","a",function(t){var n=$(this),i=n.parents(".gallery"),r=i.children(".modal"),o=r.find("img"),s=n.attr("href");s&&s.match(/\.(jpg|gif|png|mp4)$/)&&(t.preventDefault(),t.stopPropagation(),r[0]._locked||(r[0]._locked=!0,r.data("cur",n),o.attr("src",s),r.addClass("visible"),r.focus(),e.$main.addClass("no-scroll"),setTimeout(function(){r[0]._locked=!1},300)))}).on("click",".modal",function(t){var n=$(this),i=n.find("img");n[0]._locked||n.hasClass("visible")&&(n[0]._locked=!0,n.removeClass("loaded"),setTimeout(function(){n.removeClass("visible"),e.$main.removeClass("no-scroll"),setTimeout(function(){i.attr("src",""),n[0]._locked=!1,n.removeData("cur"),e.$body.focus()},175)},125))}).on("click",".prev",function(e){var t=$(this).parents(".gallery").children(".modal"),n=t.data("cur");if(n){var i=n.parent().prev().find("a");i&&i.length||(i=n.parent().parent().children().last().find("a")),i&&i.length&&i.trigger("click")}}).on("click",".next",function(e){var t=$(this).parents(".gallery").children(".modal"),n=t.data("cur");if(n){var i=n.parent().next().find("a");i&&i.length||(i=n.parent().parent().children().first().find("a")),i&&i.length&&i.trigger("click")}}).on("keydown",".modal",function(e){var t=$(this);switch(e.keyCode){case 27:t.trigger("click");break;case 37:t.parent().find(".prev").trigger("click");break;case 39:t.parent().find(".next").trigger("click")}}).prepend('<div class="modal" tabIndex="-1"><a class="prev icon style2 fa-angle-left"></a><div class="inner"><img src="" /></div><a class="next icon style2 fa-angle-right"></a></div>').find("img").on("load",function(e){var t=$(this),n=t.parents(".modal");setTimeout(function(){n.hasClass("visible")&&n.addClass("loaded")},275)})}n.init=i}(t.gallery||(t.gallery={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(e){!function(t){function n(e){$(".map",e).q().ForEach(function(e){return l.push(i(e))})}function i(e){var t={element:e},n=parseFloat(e.attr("lat")),i=parseFloat(e.attr("lng")),l=parseFloat(e.attr("zoom"));return n&&i&&(t.start={lat:n,lng:i}),l&&(t.zoom=l),t.marker=$q($(".marker",e)).Select(function(e){return{position:{lat:parseFloat(e.attr("lat")),lng:parseFloat(e.attr("lng"))},title:e.text()}}).ToArray(),window["initMap"+a]=function(){r(t)},o?r(t):(e.after('<script async defer src="https://maps.googleapis.com/maps/api/js?key='+s+"&callback=initMap"+a+'"><\/script>'),o=!0),a++,t}function r(t){var n,i=new google.maps.Map(t.element[0],{center:t.start?{lat:t.start.lat,lng:t.start.lng}:null,zoom:t.zoom,styles:e.mapStyle});$q(t.marker).ForEach(function(e){new google.maps.Marker({position:new google.maps.LatLng(e.position.lat,e.position.lng),title:e.title}).setMap(i)});t.element.mouseenter(function(){n||(n=t.element.children().first(),n.mouseleave(function(){n.addClass("no-pointer-events")})),n.addClass("no-pointer-events")}),t.element.click(function(){n.removeClass("no-pointer-events")})}var o,s="AIzaSyBdO_cpM267sMdq2GO-ujjfch3dMjUHMjY",a=0,l=[];t.init=n}(e.map||(e.map={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(e){e.mapStyle=[{stylers:[{saturation:-100},{gamma:1}]},{elementType:"labels.text.stroke",stylers:[{visibility:"off"}]},{featureType:"poi.business",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"poi.business",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"poi.place_of_worship",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"poi.place_of_worship",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"geometry",stylers:[{visibility:"simplified"}]},{featureType:"water",stylers:[{visibility:"on"},{saturation:50},{gamma:0},{hue:"#50a5d1"}]},{featureType:"administrative.neighborhood",elementType:"labels.text.fill",stylers:[{color:"#333333"}]},{featureType:"road.local",elementType:"labels.text",stylers:[{weight:.5},{color:"#333333"}]},{featureType:"transit.station",elementType:"labels.icon",stylers:[{gamma:1},{saturation:50}]}]}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){!function(n){function i(){t.link.init(a),s.click(function(){e.$main.hasClass("menu-opened")?o():r()}),a.click(function(e){var t=$(e.target);("menu"==t.attr("id")||t.hasClass("icon"))&&o()})}function r(){s.addClass("fa-close").removeClass("fa-bars"),e.$main.addClass("menu-opened").addClass("no-scroll"),a.addClass("opened")}function o(){s.addClass("fa-bars").removeClass("fa-close"),e.$main.removeClass("menu-opened").removeClass("no-scroll"),a.removeClass("opened")}var s=$("#menu-btn"),a=$("#menu");n.init=i,n.open=r,n.close=o}(t.menu||(t.menu={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){$.fn.timeline=function(){return this.data("timeline")};!function(e){function t(e){$(".timeline",e).each(function(e,t){new n($(t))})}e.init=t}(t.timeline||(t.timeline={}));var n=function(){function n(n){this.element=n.data("timeline",this),this.page=e.$util.getPage(this.element),this.initBlocks(),this.initScrolling(),t.link.init(n)}return n.prototype.initScrolling=function(){var t=this;this.hideBlocks(),e.$window.on("scroll",function(){t&&t.hasBlocks()&&t.pageIsActive()&&(window.requestAnimationFrame?window.requestAnimationFrame(function(){t.showBlocks()}):setTimeout(function(){t.showBlocks()},100))})},n.prototype.hasBlocks=function(){return this.blocks&&this.blocks.length>0},n.prototype.pageIsActive=function(){return this.page&&this.page.pageCnt.hasClass("current")},n.prototype.initBlocks=function(){this.blocks=$(".timeline-block",this.element)},n.prototype.hideBlocks=function(){var e=this;this.blocks.each(function(t,n){e.hideBlock($(n))})},n.prototype.showBlocks=function(){var e=this;this.blocks.each(function(t,n){e.showBlock($(n))})},n.prototype.refreshBlocks=function(){var e=this;this.blocks.each(function(t,n){var i=$(n);e.hideBlock(i),e.showBlock(i)})},n.prototype.hideBlock=function(t){t.offset().top>e.$window.scrollTop()+e.$window.height()*n.offset&&t.find(".timeline-img, .timeline-content").addClass("is-hidden")},n.prototype.showBlock=function(t){t.offset().top<=e.$window.scrollTop()+e.$window.height()*n.offset&&t.find(".timeline-img").hasClass("is-hidden")&&t.find(".timeline-img, .timeline-content").removeClass("is-hidden").addClass("bounce-in")},n.offset=.8,n}();t.Timeline=n}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(e){!function(e){function t(e,t){return new n(e,t)}e.init=t;var n=function(){function e(t,n){var i=this;this.context=t,this.context.each(function(e,t){$(t).data("scrollex",i)});var r=this,o=n.initialize,s=n.terminate,a=n.enter,l=n.leave;this.options=n=$.extend({},e.defaultOptions,n,{initialize:function(){r.initialize($(this),o)},terminate:function(){r.terminate($(this),s)},enter:function(){r.enter($(this),a)},leave:function(){r.leave($(this),l)}}),this.context.scrollex(n)}return e.prototype.initialize=function(e,t){!this.options.enabled||t&&!1===t(this,e)||e.addClass(this.options.inactiveClass)},e.prototype.terminate=function(e,t){!this.options.enabled||t&&!1===t(this,e)||e.removeClass(this.options.inactiveClass)},e.prototype.enter=function(e,t){!this.options.enabled||t&&!1===t(this,e)||e.removeClass(this.options.inactiveClass)},e.prototype.leave=function(e,t){if(this.options.enabled&&(!t||!1!==t(this,e))){var n=this.options;(1==n.bidirectional||n.bidirectional&&e.hasClass(n.bidirectional))&&e.addClass(n.inactiveClass)}},e.defaultOptions={enabled:!0,top:"30vh",bottom:"30vh",inactiveClass:"is-inactive",bidirectional:"onscroll-bidirectional"},e}();e.Scrollex=n}(e.scrollex||(e.scrollex={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){function n(e,n){u(e),t.section.init(e,n),t.img.init(e),t.items.init(e),t.events.init(e),t.gallery.init(e),t.timeline.init(e),t.map.init(e),t.link.init(e),t.$scrollCnt.trigger("scroll")}function i(){c(),a(),l(),t.menu.init()}function r(){skel.breakpoints({xlarge:"(max-width: 1680px)",large:"(max-width: 1280px)",medium:"(max-width: 980px)",small:"(max-width: 736px)",xsmall:"(max-width: 480px)",xxsmall:"(max-width: 360px)",minxlarge:"(min-width: 1680px)",minlarge:"(min-width: 1280px)",minmedium:"(min-width: 980px)",minsmall:"(min-width: 736px)",minxsmall:"(min-width: 480px)",minxxsmall:"(min-width: 360px)"})}function o(t,n,i,r,o){o||(o=$.Deferred());var a=t.page||"main";return e.$pages.exists(a+"-"+t.dest)&&(a+="-"+t.dest),e.$pages.load(a).done(function(a){var l=t.dest?$("#"+t.dest):null;l&&l.length||(l=a.pageCnt),n||(n=l.attr("anchor")||"top"),i||(i=l.attr("speed")||"normal");var c;r&&(c=a.remOffset()),void 0==c&&(c=e.$util.getOffset(l,n)),s(c,n,i,o)}).fail(function(e){o.reject(e)}),o.promise()}function s(e,n,i,r){if(void 0===n&&(n="top"),void 0===i&&(i="normal"),r||(r=$.Deferred()),"immediate"==i)t.$scrollCnt.stop().scrollTop(e),setTimeout(function(){r.resolve()},100);else{var o=1e3;"slow"==i?o=2e3:"fast"==i&&(o=300),t.$scrollCnt.stop().animate({scrollTop:e},o,"swing",function(){r.resolve()})}return r.promise()}function a(){t.$backBtn.click(function(t){t&&t.preventDefault(),e.$app.back()})}function l(){var t=$("#lang-btn"),n=function(n){var i=e.$window.height(),r=e.$window.scrollTop();t.toggleClass("hidden",r>i/2||e.$pages.current&&e.$pages.current.pageCnt.hasClass("no-lang-btn"))};e.$window.scroll(n),e.$window.resize(n),n()}function c(){if("ie"==skel.vars.browser){var t;e.$window.on("resize.flexbox-fix",function(){var n=$(".fullscreen");clearTimeout(t),t=setTimeout(function(){n.prop("scrollHeight")>e.$window.height()?n.css("height","auto"):n.css("height","100vh")},250)}).triggerHandler("resize.flexbox-fix")}}function u(e){skel.canUse("object-fit")||$(".banner .image, .spotlight .image",e).each(function(e,t){var n=$(t),i=n.children("img"),r=n.parent().attr("class").match(/image-position-([a-z]+)/);switch(n.css("background-image",'url("'+i.attr("src")+'")').css("background-repeat","no-repeat").css("background-size","cover"),r.length>1?r[1]:""){case"left":n.css("background-position","left");break;case"right":n.css("background-position","right");break;case"center":default:n.css("background-position","center")}i.css("opacity","0")})}t.$scrollCnt=$("body,html"),t.$backBtn=$("#back-btn"),t.init=n,t.initCommon=i,t.initSkel=r,t.scrollTo=o,t.scrollToPos=s}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){!function(n){var i=function(){function n(e,t,n){this.name=e,this.id=t,this.parse=n}return n.prototype.q=function(){return new r(this)},n.prototype.set=function(n,i){var r=this,o=Array.isArray(i)?i:[i];return"post"==n&&this.id&&$q(o).ForEach(function(e){return delete e[r.id]}),t[n]("/"+e.$cfg.ctx.db+"/_table/"+this.name,{resource:o}).then(function(e){return e&&e.resource&&e.resource.length&&$q(e.resource).ForEach(function(e,t){return $.extend(o[t],e)}),Array.isArray(i)?$q(i).Select(function(e){return r.parse(e)}).ToArray():r.parse(i)})},n.prototype.insert=function(e){return this.set("post",e)},n.prototype.update=function(e){return this.set("put",e)},n}();n.DBTable=i;var r=function(){function n(t){this._table=t,this._url="/"+e.$cfg.ctx.db+"/_table/"+t.name}return n.prototype.select=function(e){return this._select=e,this},n.prototype.where=function(e){return this._where=e,this},n.prototype.related=function(e){return this._related=e,this},n.prototype.orderBy=function(e){return this._orderBy=e,this},n.prototype.groupBy=function(e){return this._groupBy=e,this},n.prototype.limit=function(e){return this._limit=e,this},n.prototype.offset=function(e){return this._offset=e,this},n.prototype.parseSingle=function(e){return e?this._table.parse?this._table.parse(e):e:null},n.prototype.parseMany=function(e){var t=this;return e&&e.resource?this._table.parse?$q(e.resource).Select(function(e){return t._table.parse(e)}).ToArray():e.resource:[]},n.prototype.get=function(e){var n=this,i={};return this._select&&(i.fields=this._select),t.get(this._url+"/"+e,i).then(function(e){return n.parseSingle(e)})},n.prototype.find=function(){var e=this,n={};return this._select&&(n.fields=this._select),this._where&&(n.filter=this._where),this._orderBy&&(n.order=this._orderBy),this._groupBy&&(n.group=this._groupBy),this._limit&&(n.limit=this._limit),this._offset&&(n.offset=this._offset),this._related&&(n.related=this._related),t.get(this._url,n).then(function(t){return e.parseMany(t)})},n}();n.DBQuery=r,n.event=new i("event","eventId",function(t){return new e.MTBEvent(t)})}(t.db||(t.db={}))}(e.$ctx||(e.$ctx={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){!function(n){function i(){return(n.current?n.current.session_token:null)||Cookies.get(g)}function r(){return b.promise()}function o(e,n,i){return void 0===i&&(i=0),b||(b=$.Deferred()),t.post("/user/session",{email:e,password:n,duration:i||0}).always(function(){b&&b.resolve()}).then(function(e){return c(e)}).fail(function(e,t,n){return c(null)})}function s(e){return b||(b=$.Deferred()),t.post("/hashauth",{hash:e}).always(function(){b&&b.resolve()}).then(function(e){return c(e)}).fail(function(e,t,n){return c(null)})}function a(){return b||(b=$.Deferred()),n.current&&n.current.session_token?t.del("/user/session").always(function(){b&&b.resolve()}).then(function(){return c(null)}):(b&&b.resolve(),$.Deferred().resolve().promise())}function l(){b||(b=$.Deferred());var e=n.current?n.current.session_token:null;return e||(e=Cookies.get(g)),e?t.put("/user/session").always(function(){b&&b.resolve()}).then(function(e){return c(e)}).fail(function(e,t,n){return c(null)}):(b&&b.resolve(),$.Deferred().reject().promise())}function c(e){return n.current=e,n.current?Cookies.set(g,n.current.session_token,{expires:1}):Cookies.remove(g),n.current}function u(){var t=(n.current?n.current.role:"")||"";return e.$cfg.roles[t]}function p(t){for(var n=t.split("/").reverse(),i=e.$cfg.access;i&&n.length;)i=i[n.pop()];return!i||($q(i).Contains(u())||$q(i).Contains("*"))}function f(){return null==n.current||null==n.current.role||"Alpbrothers WWW"==n.current.role}function d(){return null!=n.current&&"Alpbrothers Partner"==n.current.role}function h(){return null!=n.current&&"Alpbrothers Admin"==n.current.role}function v(){return null!=Cookies.get(y)}function m(){Cookies.set(y,"true",{expires:365})}var g="alpbros_session",y="alpbros_cookie_agreement";n.current=null;var b=$.Deferred().resolve();n.token=i,n.wait=r,n.signin=o,n.hashauth=s,n.signout=a,n.refresh=l,n.granted=p,n.isPublic=f,n.isPartner=d,n.isAdmin=h,n.hasCookieAgreement=v,n.agreeCookies=m}(t.session||(t.session={}))}(e.$ctx||(e.$ctx={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){function n(n,i,r){return t.session.wait().then(function(){return!r||"POST"!=n&&"PUT"!=n||(r=JSON.stringify(r)),$.ajax({type:n,url:e.$cfg.ctx.baseurl+i,data:r||{},accepts:{json:"application/json"},contentType:"application/json",headers:{"X-DreamFactory-API-Key":e.$cfg.ctx.apikey,"X-DreamFactory-Session-Token":t.session.token()}})})}function i(e,t){return n("GET",e,t)}function r(e,t){return n("POST",e,t)}function o(e,t){return n("PUT",e,t)}function s(e,t){return n("DELETE",e,t)}t.call=n,t.get=i,t.post=r,t.put=o,t.del=s}(e.$ctx||(e.$ctx={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){var n=function(){function t(t,n,i){this.name=t,this.pageCnt=n,this.pageCnt.data("page",this),this.pageCnt.hasClass("init-ui")&&(e.$ui.init(this.pageCnt),this.pageCnt.removeClass("init-ui"))}return t.prototype.isCurrent=function(){return this.pageCnt.hasClass("current")},t.prototype.isHidden=function(){return this.pageCnt.hasClass("hidden")},t.prototype.defaultBack=function(){return this.pageCnt.attr("back")},t.prototype.remOffset=function(e){if(null===e)this.pageCnt.removeAttr("offset");else{if(void 0===e){var t=this.pageCnt.attr("offset");return null!=t?parseInt(t):null}this.pageCnt.attr("offset",e)}},t.prototype.load=function(e){e&&e.resolve(this)},t}();t.Page=n}(e.$pages||(e.$pages={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){var n=function(t){function n(n,i,r){var o=t.call(this,n,i,r)||this;return e.$ui.initCommon(),e.$ui.init(i,{setHashOnScroll:Modernizr.history}),r.resolve(o),o}return __extends(n,t),n}(t.Page);t.PageMain=n}(e.$pages||(e.$pages={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){var n=function(t){function n(n,i,r){var o=t.call(this,n,i,r)||this;return o.timelineCnt=$("#event-timeline"),e.$data.waitEvents.done(function(){o.initTimeline(!0),r.resolve(o)}).fail(function(){r.reject()}),e.$data.change(function(){o.initTimeline(!1)}),o}return __extends(n,t),n.prototype.load=function(e){this.timeline.hasBlocks()||this.timeline.initBlocks(),this.timeline.refreshBlocks(),e.resolve(this)},n.prototype.initForm=function(){var t=this;e.$ui.init($("form",this.pageCnt)),$("input#event-from-date",this.pageCnt).val((new Date).toISOString().substr(0,10));var n=$("select#event-type",this.pageCnt);$q(e.MTBEventTypes).ForEach(function(e){var t=e.Value;n.append('<option value="'+t.id+'">'+t.description+"</option>")}),$("input,select",this.pageCnt).change(function(){return t.filterTimeline()})},n.prototype.initTimeline=function(t){this.appendEvents(),e.$ui.init(this.timelineCnt.parent()),t&&this.initForm(),this.timeline=this.timelineCnt.timeline(),this.filterTimeline()},n.prototype.appendEvents=function(){var t=this;this.timelineCnt.empty(),this.timelineItems=$q(e.$data.events).Where(function(e){return e.isOccurrence()}).Select(function(e){return{event:e,item:t.getTimelineItem(e)}}).ToArray(),this.timelineCnt.append($q(this.timelineItems).Select(function(e,t){return e.item.toggleClass("even",t%2!=0)}).ToArray())},n.prototype.filterTimeline=function(){var t,n=(t=$("#event-from-date").val())?moment(t):null,i=(t=$("#event-to-date").val())?moment(t):null,r=$("#event-type").val(),o=e.MTBLevel.Everyone|($("#event-level-beginner").is(":checked")?e.MTBLevel.Beginner:e.MTBLevel.Everyone)|($("#event-level-advanced").is(":checked")?e.MTBLevel.Advanced:e.MTBLevel.Everyone),s=0;$q(this.timelineItems).ForEach(function(t){var a=t.event,l=n&&a.from()<n||i&&a.to()>i||r&&"all"!=r&&a.typeId()!=r||o<e.MTBLevel.All&&a.level()!=e.MTBLevel.Everyone&&0==(a.level()&o);t.item.toggleClass("hidden",l),l||(t.item.toggleClass("even",s%2!=0).toggleClass("first-child",0==s),s++)}),this.timeline.refreshBlocks()},n.prototype.getTimelineItem=function(t){var n=t.isErlebniscard()?e.$res.events.erlebniscardPrice:t.price(),i=e.$res.events.eventUrl.format(t.eventId()),r=e.$res.events.editUrl.format(t.seriesId(),t.eventId());return $('<div class="timeline-block" eventId="'+t.eventId()+'"><div class="timeline-img bg-color-'+this.getLevelColor(t)+'" title="'+t.type().name+'"><span class="icon style2 major '+t.type().icon+'"></span></div><div class="timeline-content"><h3>'+t.name()+'<br /><code><span class="icon fa-money"></span> '+n+'</code></h3><p><img src="'+t.img()+'" /><strong>'+e.$util.formatFromTo(t.from(),t.to(),e.$res.events.dateFormat,e.$res.events.multiDayFormat)+"<br />"+e.$res.events.level+": "+e.$res.level[e.MTBLevel[t.level()]]+"</strong><br /><br />"+t.description()+'</p><br style="clear: both;" /><a href="'+i+'" class="button special icon fa-pencil">'+e.$res.events.details+'</a> <a href="'+r+'" class="button icon fa-pencil role-admin">'+e.$res.events.edit+'</a><span class="date">'+e.$util.formatDate(t.from(),e.$res.events.fromFormat)+"</span></div></div>").data("event",t)},n.prototype.getLevelColor=function(t){switch(t.level()){case e.MTBLevel.Beginner:return"green";case e.MTBLevel.Advanced:return"orange";default:return"blue"}},n}(t.Page);t.PageEvents=n}(e.$pages||(e.$pages={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){var n=function(t){function n(n,i,r){var o=t.call(this,n,i,r)||this;return e.$data.waitEvents.done(function(){e.$ui.init(i),r.resolve(o)}),o}return __extends(n,t),n.prototype.load=function(t){if(!e.$url.args.id)return void(t&&t.reject("Missing eventId and/or date!"));t&&t.resolve(this)},n}(t.Page);t.PageEvent=n}(e.$pages||(e.$pages={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){var n=function(t){function n(e,n,i){var r=t.call(this,e,n,i)||this,o=r,s=["type","level","name-de","name-en","short-descr-de","short-descr-en","descr-de","descr-en","requirements-de","requirements-en","from","to"];return $q(s).ForEach(function(e){r[e.replace(/-/g,"_")]=r.input(e)}),r.img=$(".event-img",n).click(function(){$(".event-img.selected",n).removeClass("selected"),$(this).addClass("selected")}),r.input("from").change(function(){o.copyFromDate($(this))}),r.datesTbl=$("table.dates",n),$("a.add-date",r.datesTbl).click(function(){return r.addDate()}),$("a.button.save",r.pageCnt).click(function(){r.save()}),i.resolve(r),r}return __extends(n,t),n.prototype.load=function(t){if(this.pageCnt.attr("mode",this.mode=e.$url.dest||"edit"),"edit"==this.mode){var n=parseInt(e.$url.args.id);if(null==n||isNaN(n))return t.reject("Missing event id!");if(this.editEvent=e.$data.eventMap.Get(n),!this.editEvent)return t.reject("Missing event "+n);this.initInputFields(this.editEvent)}else this.initInputFields(new e.MTBEvent({}));t&&t.resolve(this)},n.prototype.initInputFields=function(t){this.input("name-de").val(t.name_de()),this.input("name-en").val(t.name_en());var n=t.type()||e.MTBEventTypes.TechniqueTraining;this.input("type").val(n.name);var i=t.status()||e.MTBEventStatus.TakesPlace;this.input("status").val(e.MTBEventStatus[i]);var r=t.level();this.input("level","[value="+e.MTBLevel[r]+"]").click(),this.input("price-type","[value="+(t.isErlebniscard()?"erlebniscard":"price")+"]").click(),t.isErlebniscard()||this.input("price").val(parseInt(t.price())),this.input("short-descr-de").val(t.shortDescription_de()),this.input("short-descr-en").val(t.shortDescription_en()),this.input("descr-de").val(t.description_de()),this.input("descr-en").val(t.description_en());var o=t.img(!1);$(".event-img"+(o?"[value='"+o+"']":".first"),this.pageCnt).click(),this.occurrences=t.occurrences(),this.refreshDatesTbl()},n.prototype.addDate=function(){
var t=moment(this.from.val()),n=moment(this.to.val());return t.isValid()?n.isValid()?$q(this.occurrences).Any(function(e){return e.from().isSame(t)&&e.to().isSame(n)})?alert("Duplicate date"):(this.occurrences.push(new e.MTBEvent({from:t.toISOString(),to:n.toISOString()})),void this.refreshDatesTbl()):alert("Invalid to date!"):alert("Invalid from date!")},n.prototype.refreshDatesTbl=function(){var e=this;this.occurrences=$q(this.occurrences).Distinct(function(e){return e.from().toISOString()+"-"+e.to().toISOString()}).ToArray();var t=$("tbody",this.datesTbl).empty();$q(this.occurrences).OrderBy(function(e){return e.from()}).ForEach(function(n){t.append(e.getDateRow(n))})},n.prototype.getDateRow=function(t){var n=this,i=this;return $("<tr>").data("event",t).append($("<td>").addClass("event-from").text(t.from().format(e.$res.event.edit.dateFormat)).change(function(){i.copyFromDate($(this))}),$("<td>").addClass("event-to").text(t.to().format(e.$res.event.edit.dateFormat)),$("<td>").append($("<a>").addClass("icon style2 fa-repeat").attr("title",e.$res.event.edit.repeat).click(function(){n.occurrences.push(new e.MTBEvent({from:t.from().clone().add(7,"days").toISOString(),to:t.to().clone().add(7,"days").toISOString()})),n.refreshDatesTbl()}),$("<a>").addClass("icon style2 fa-pencil mode-edit").click(function(){}),$("<a>").addClass("icon style2 fa-minus").click(function(){n.occurrences=$q(n.occurrences).Where(function(e){return e!==t}).ToArray(),n.refreshDatesTbl()})))},n.prototype.copyFromDate=function(t){var n=t.val();if(n){var i=e.MTBEventTypes[this.input("type").val()];t.parent().next().find("input[name=event-to]").val(moment(n).add(i.duration,"hours").format("YYYY-MM-DDTHH:mm"))}},n.prototype.input=function(e,t){return $("[name=event-"+e+"]"+(t||""),this.pageCnt)},n.prototype.getMainEvent=function(){return 0==this.occurrences.length?null:{eventId:0,parentId:null,from:null,to:null,type:e.MTBEventTypes[this.input("type").val()].id,status:e.MTBEventStatus[this.input("status").val()],name:this.input("name-de").val(),name_en:this.input("name-en").val(),shortDescription:this.input("short-descr-de").val(),shortDescription_en:this.input("short-descr-en").val(),description:this.input("descr-de").val(),description_en:this.input("descr-en").val(),price:this.getPrice(),level:e.MTBLevel[this.input("level",":checked").val()],img:$(".event-img.selected",this.pageCnt).attr("value")}},n.prototype.getOccurrences=function(e){return $q(this.occurrences).Select(function(t){return t.state.parentId=e.eventId(),t.state}).ToArray()},n.prototype.getPrice=function(){return"erlebniscard"==this.input("price-type",":checked").val()?e.MTBEvent.ErlebniscardPrice:this.input("price").val()},n.prototype.save=function(){var t=this;0==this.occurrences.length&&this.input("from").val()&&this.input("to").val()&&$("a.add-date",this.pageCnt).click();var n=this.getMainEvent();e.$ui.loader.show(),"add"==this.mode&&e.$ctx.db.event.insert(n).done(function(n){var i=t.getOccurrences(n);e.$ctx.db.event.insert(i).done(function(t){e.$data.addEvent([n].concat(t)),e.$app.hashChange("#/event/edit?id="+n.eventId())})}).always(function(){e.$ui.loader.hide()})},n}(t.Page);t.PageEventEdit=n}(e.$pages||(e.$pages={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){var n=function(t){function n(n,i,r){var o=t.call(this,n,i,r)||this;return e.$ui.init(i),o.signInBtn=$("#signin-btn",i).click(function(e){e&&e.preventDefault(),o.signIn()}),o.email=$("#signin-email",o.pageCnt),o.pwd=$("#signin-pwd",o.pageCnt),o.errorLbl=$("#signin-error",o.pageCnt),r.resolve(o),o}return __extends(n,t),n.prototype.signIn=function(){var t=this;e.$ui.loader.show(),e.$cmd.exec("signin",{email:this.email.val(),pwd:this.pwd.val(),return:e.$url.args?e.$url.args.return:null}).always(function(){e.$ui.loader.hide(),t.email.val(""),t.pwd.val("")}).done(function(){t.errorLbl.addClass("hidden")}).fail(function(e,n,i){t.errorLbl.text(i).removeClass("hidden")})},n}(t.Page);t.PageSignin=n}(e.$pages||(e.$pages={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){var n=function(t){function n(n,i,r){var o=t.call(this,n,i,r)||this;return e.$ui.init(i),r.resolve(o),o}return __extends(n,t),n.prototype.load=function(t){var n=e.$ctx.session.current;if(!n||n.role_id!=e.Roles.Admin)return void t.reject({redirect:"#/signin?return=/admin"});t.resolve(this)},n}(t.Page);t.PageAdmin=n}(e.$pages||(e.$pages={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){function n(i,l){var p=e.$cfg.pages[i];if(null==p)return $.Deferred().reject("Missing page "+i).fail(function(e){r(e,i,l)}).promise();if(!e.$ctx.session.granted("page/"+i))return l?$.Deferred().reject("Unauthorized page preload "+i).promise():$.Deferred().reject("Unauthorized page load "+i).fail(function(e){r(e,i,l)}).promise();if(p.synname)return n(p.synname,l);var f=c[i];if(!f){var d=$.Deferred().fail(function(e){r(e,i,l)});f=d.promise();var h,v=a(i);if(!v&&!(h=s(i)))return d.reject().promise();v?d.resolve(v):(l||e.$ui.loader.show(),o(i).then(function(e){v=u[i]=new h(i,e,d),h==t.Page&&d.resolve(v)},function(){d.reject()}))}return(c[i]=f.then(function(e){if(!e.load||l)return e;var t=$.Deferred();return e.load(t),t}).then(function(n){return t.current||(t.current=n),l||(e.$ui.loader.hide(),t.current!=n&&(t.current&&(t.current.pageCnt.removeClass("current").addClass("hidden"),t.current.pageCnt.trigger("pagehide")),(t.current=n).pageCnt.addClass("current").removeClass("hidden"),t.current.pageCnt.trigger("pageload")),e.$ui.$backBtn.toggleClass("hidden",t.current==a("main"))),n})).fail(function(e){r(e,i,l)})}function i(e){return n(e,!0)}function r(t,n,i){if(e.$ui.loader.hide(),delete c[n],t&&t.redirect)return e.$app.hashChange(t.redirect);i||e.$app.back(),console.error("Could not load page "+n+"! "+t)}function o(t){var n=$("#"+t+".page");return n.length>0?$.Deferred().resolve(n).promise():$.ajax({type:"GET",url:"pages/"+t+".html"}).then(function(i){return i||(i='<div id="'+t+'"></div>'),n=$(i),e.$body.append(n),n})}function s(e){var n=e.split("-");return e=$q(n).Select(function(e){return e[0].toUpperCase()+e.substr(1)}).ToArray().join(""),t["Page"+e]||t.Page}function a(e){return u[e]}function l(t){return null!=e.$cfg.pages[t]}var c={},u={};t.load=n,t.preload=i,t.get=a,t.exists=l}(e.$pages||(e.$pages={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){var n=function(){function t(){}return t.prototype.exec=function(t){var n=t.hash,i=t.email,r=t.pwd;if(!(n||i&&r))return $.Deferred().reject("Missing credentials!").promise();var o=t.return||"#/";return e.$ui.loader.show(),(n?e.$ctx.session.hashauth(n):e.$ctx.session.signin(i,r)).always(function(){e.$ui.loader.hide()}).done(function(t){return e.$app.setAuthenticated(!0),e.$app.hashChange(e.$util.ensureStartsWith(o,"#"))}).fail(function(e,t,n){console.error(n)})},t}();t.CmdSignin=n}(e.$cmd||(e.$cmd={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){var n=function(){function t(){}return t.prototype.exec=function(t){return e.$ctx.session.signout().always(function(){e.$app.back()}).done(function(){e.$app.setAuthenticated(!1)})},t}();t.CmdSignout=n}(e.$cmd||(e.$cmd={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){var n=function(){function t(){}return t.prototype.exec=function(t){return e.$ctx.session.agreeCookies(),e.$app.setCookieAgreement(!0),e.$app.back(),$.Deferred().resolve().promise()},t}();t.CmdAgreeCookies=n}(e.$cmd||(e.$cmd={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(e){function t(t,i){var r=e[n(t)];return r?(new r).exec(i||{}):$.Deferred().reject("Cmd "+t+" not found!").promise()}function n(e){var t=e.split("-");return"Cmd"+(e=$q(t).Select(function(e){return e[0].toUpperCase()+e.substr(1)}).ToArray().join(""))}function i(e){return e&&"cmd"==e.page&&e.dest?t(e.dest,e.args):$.Deferred().reject("Invalid cmd url '"+(e?e.hash:"")+"'").promise()}e.exec=t,e.execUrl=i;var r=function(){function e(){}return e.prototype.exec=function(e){return $.Deferred().resolve().promise()},e}();e.Cmd=r}(e.$cmd||(e.$cmd={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){e.$window=$(window),e.$doc=$(document.documentElement),e.$body=$(document.body),e.$main=$("#main.page");!function(t){function n(t){e.$cfg.init(t),Modernizr.history&&(history.scrollRestoration="manual",u=history.length),e.$window.on("hashchange",function(){p||i()}),Modernizr.history&&e.$window.on("popstate",function(){f||(d=!0)});var n;e.$doc.click(function(){n||(e.$ctx.session.refresh().done(function(){l(!0)}).fail(function(){l(!1)}),n=setTimeout(function(){n=null},15e3))}),e.$data.init(),c(e.$ctx.session.hasCookieAgreement()),e.$ctx.session.refresh().done(function(){l(!0)}).fail(function(){l(!1)}).always(function(){e.$pages.preload("main").done(function(){i(void 0,void 0,"immediate").done(function(){$q(e.$cfg.pages).Where(function(e){return e.Value.preload}).ForEach(function(t){return e.$pages.preload(t.Key)})})})})}function i(n,i,s){if(p=!0,d||(f=!0),e.$url=e.$util.parseUrl(n||window.location.hash),"cmd"==e.$url.page)return e.$cmd.execUrl(e.$url).fail(function(e){return console.error(e),t.back()});var l=e.$pages.current&&e.$url.page!=e.$pages.current.name;n&&window.location.hash!=n&&(l&&(e.$ui.$backBtn.attr("href",window.location.hash),window.location.hash=n),Modernizr.history&&o(n)),l&&(s="immediate",document.title=r(e.$url),d||e.$pages.current.remOffset(e.$window.scrollTop()));var c=e.$url.args;return c&&(c.anchor&&(i=c.anchor),c.speed&&(s=c.speed)),e.$ui.scrollTo(e.$url,i,s,d).fail(function(e){a()}).done(function(){p=f=d=!1})}function r(t){var n=e.$res[t.page],i=t.dest&&n?n[t.dest]:null;return i&&i.title?i.title:n&&n.title?n.title:e.$res.main.title}function o(e){history.replaceState(e,void 0,e)}function s(){i("#/")}function a(t){d=!0,t||(t=e.$ui.$backBtn.attr("back")||e.$pages.current&&e.$pages.current.defaultBack()||"#/"),i(t)}function l(t){e.$doc.toggleClass("authenticated",t).toggleClass("unauthenticated",!t).toggleClass("role-public",e.$ctx.session.isPublic()).toggleClass("role-partner",e.$ctx.session.isPartner()).toggleClass("role-admin",e.$ctx.session.isAdmin())}function c(t){e.$doc.toggleClass("missing-cookie-agreement",!t)}var u,p=!1,f=!1,d=!1;t.init=n,t.hashChange=i,t.setHash=o,t.home=s,t.back=a,t.setAuthenticated=l,t.setCookieAgreement=c}(e.$app||(e.$app={})),e.$ui.initSkel()}($alpbros||($alpbros={}));