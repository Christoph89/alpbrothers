"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),$alpbros;!function(e){!function(e){e[e.Partner=2]="Partner",e[e.WWW=3]="WWW",e[e.Admin=4]="Admin"}(e.Roles||(e.Roles={}));!function(e){e[e.Everyone=0]="Everyone",e[e.Beginner=1]="Beginner",e[e.Advanced=2]="Advanced",e[e.All=3]="All"}(e.MTBLevel||(e.MTBLevel={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){function n(e,t){return e.format(t)}function i(e,t,n,i){i&&!r(e,t)&&(n=i);var o=n.split("-");return e.format(o[0].trim())+" - "+t.format(o[1].trim())}function r(e,t){return e.year()==t.year()&&e.month()==t.month()&&e.date()==t.date()}function o(e,t){return e&&e.isValid()?(0==e.hour()&&0==e.minute()&&(e.hour(t.hour()),e.minute(t.minute())),e):t.clone()}function a(e,t){return o(moment(e),moment(t))}function s(e,t){return null==e&&(e=""),e[0]==t?e:t+e}function l(e,t){if(void 0===t&&(t="top"),e="string"==typeof e?$(e):e,0==e.length)return null;var n=e.offset().top;return"middle"==t?n-($(window).height()-e.outerHeight())/2:Math.max(n,0)}function c(t,n){if(!t)return null;n||(n="name");var i=t[n+"_"+e.$cfg.lang];return void 0===i&&(i=t[n]),i}function u(e){for(var t=e;t&&!t.hasClass("page");)t=t.parent();return t.hasClass("page")?t.data("page"):null}function p(t){t=t.replace("#/","").replace("#","");var n={hash:"#/"+t},i=t.split("?"),r=(i[0]||"").split("/");return n.page=r[0],"cmd"==n.page||e.$pages.exists(n.page)?n.dest=r[r.length-1]:(n.dest=n.page,n.page="main"),n.args=f(i[1]),n}function f(e){if(!e)return null;var t={};return $q(e.split("&")).ForEach(function(e){var n=e.split("=");t[n[0]]=n[1]}),t}t.formatDate=n,t.formatFromTo=i,t.dateEquals=r,t.mergeDates=o,t.mergeDatesStr=a,t.ensureStartsWith=s,t.getOffset=l,t.localize=c,t.getPage=u,t.parseUrl=p,t.splitArgs=f}(e.$util||(e.$util={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){function n(t){$.extend(this,t),e.$res=t.res,i(),r()}function i(){$q(e.MTBEventTypes).ForEach(function(t){return $.extend(t.Value,e.$res.eventTypes[t.Key])}),moment.locale(t.lang)}function r(){$q(t.pages).ForEach(function(e){$q(e.Value.synonyms).ForEach(function(n){t.pages[n]={name:n,preload:!1,synonyms:[],synname:e.Key}})})}t.init=n}(e.$cfg||(e.$cfg={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){e.MTBEventTypes={},e.MTBEventTypes[0]=e.MTBEventTypes.None={id:0,name:"None",description:"@@cfg",icon:"@@cfg"},e.MTBEventTypes[1]=e.MTBEventTypes.TechniqueTraining={id:1,name:"TechniqueTraining",description:"@@cfg",icon:"@@cfg"},e.MTBEventTypes[2]=e.MTBEventTypes.GuidedTour={id:2,name:"GuidedTour",description:"@@cfg",icon:"@@cfg"},e.MTBEventTypes[3]=e.MTBEventTypes.EBikeTour={id:3,name:"EBikeTour",description:"@@cfg",icon:"@@cfg"},e.MTBEventTypes[4]=e.MTBEventTypes.Camp={id:4,name:"Camp",description:"@@cfg",icon:"@@cfg"},e.MTBEventTypes[5]=e.MTBEventTypes.MechanicalTraining={id:5,name:"MechanicalTraining",description:"@@cfg",icon:"@@cfg"}}($alpbros||($alpbros={}));var $alpbros;!function(e){var t=function(){function t(e){this.state=e}return t.prototype.get=function(t,n){switch(n){case"date":return e.$util.mergeDatesStr(this.state[t],this.p(t));case"localize":return e.$util.localize(this.state,t)||e.$util.localize(this.p(),t);default:return this.state[t]||this.p(t)}},t.prototype.p=function(e){var t=this.parent();return t&&t.state?e?t.state[e]:t.state:null},t.prototype.eventId=function(){return this.state.eventId},t.prototype.parentId=function(){return this.state.parentId},t.prototype.parent=function(){return e.$data.eventMap.Get(this.state.parentId)},t.prototype.from=function(){return this.get("from","date")},t.prototype.to=function(){return this.get("to","date")},t.prototype.typeId=function(){return this.get("type")},t.prototype.type=function(){return e.MTBEventTypes[this.typeId()]},t.prototype.name=function(){return this.get("name","localize")},t.prototype.name_de=function(){return this.get("name")},t.prototype.name_en=function(){return this.get("name_en")},t.prototype.description=function(){return this.get("description","localize")},t.prototype.description_de=function(){return this.get("description")},t.prototype.description_en=function(){return this.get("description_en")},t.prototype.price=function(){return this.get("price")},t.prototype.isErlebniscard=function(){return this.price()===t.ErlebniscardPrice},t.prototype.level=function(){return this.get("level")},t.prototype.img=function(){var t=this.get("img");return t||(t=this.type().name+".jpg"),"data:"==t.substr(0,5)?t:e.$cfg.root+e.$res.events.imgPath+t},t.prototype.tpl=function(){return this.get("tpl")},t.ErlebniscardPrice="Erlebniscard",t}();e.MTBEvent=t}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){function n(){return $.when((t.waitEvents=e.$ctx.db.event.q().orderBy("from asc").find()).then(function(e){t.events=e,t.eventMap=$q(e).ToDictionary(function(e){return e.state.eventId},function(e){return e})}))}t.init=n}(e.$data||(e.$data={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){!function(t){function n(){o||(s++,e.$body.addClass("is-loading"),o=setTimeout(function(){l.addClass("show")},a))}function i(){(s=Math.max(0,s-1))>0||(o&&(clearTimeout(o),o=null),l.removeClass("show"),e.$body.removeClass("is-loading"))}function r(e){void 0==e&&(e=!l.hasClass("show")),e?n():i()}var o,a=300,s=0,l=$("#loader");t.show=n,t.hide=i,t.toggle=r}(t.loader||(t.loader={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){!function(n){function i(n,i){var r=(n?e.$util.getPage(n):null)||e.$pages.get("main"),o=[],a=t.scrollex.init($((n?"":".page ")+"> section, section > section",n),{enter:i&&i.setHashOnScroll?function(t,n){if(e.$body.hasClass("is-loading"))return!1;var i=n.attr("href");i&&(-1==o.indexOf(i)&&o.push(i),1==o.length&&e.$app.setHash(o[0]))}:null,leave:i&&i.setHashOnScroll?function(t,n){if(e.$body.hasClass("is-loading"))return!1;var i=n.attr("href");if(i){var r=o.indexOf(i);r>-1&&(o.splice(r,1),1==o.length&&e.$app.setHash(o[0]))}}:null});r.pageCnt.on("pageload",function(){a.options.enabled=!0}),r.pageCnt.on("pagehide",function(){a.options.enabled=!1})}n.init=i}(t.section||(t.section={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){!function(t){function n(e){$("a",e).each(function(){i($(this))})}function i(t){var n=t.attr("href");n&&"#"==n[0]&&t.off("click.href").on("click.href",function(n){n&&n.preventDefault(),e.$app.hashChange(t.attr("href"),t.attr("anchor"),t.attr("speed"))})}t.init=n}(t.link||(t.link={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(e){!function(e){function t(e){Modernizr.svgasimg||$("img.svg",e).each(function(e,t){var i=$(t);i.hasClass("svg")&&n(i)})}function n(e){var t=e.attr("src");e.attr("src",t.replace(".svg",".png"))}e.init=t}(e.img||(e.img={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(e){!function(t){function n(t){e.scrollex.init($(".items",t),{delay:i}).context.children().wrapInner('<div class="inner"></div>')}var i;t.init=n}(e.items||(e.items={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){!function(t){function n(t){e.$data.waitEvents.done(function(){$(".event-table table",t).each(function(e,t){i($(t))})})}function i(t){$("tr.dummy",t).remove(),t.prepend($q(e.$data.events).Take(e.$cfg.shownEvents).Select(function(e){return r(e)}).ToArray())}function r(t){return $("<tr>").addClass("event").append($("<td>").text(t.from().format(e.$res.upcoming.dateFormat))).append($("<td>").append($("<a>")).attr("target","_blank").text(t.name())).append($("<td>").text(t.isErlebniscard()?e.$res.events.erlebniscardPrice:t.price()))}t.init=n}(t.events||(t.events={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){!function(n){function i(e){t.scrollex.init($(".gallery",e).wrapInner('<div class="inner"></div>').prepend(skel.vars.mobile?"":'<div class="forward"></div><div class="backward"></div>'),{delay:50}).context.children(".inner").css("overflow-y",skel.vars.mobile?"visible":"hidden").css("overflow-x",skel.vars.mobile?"scroll":"hidden").scrollLeft(0),r(e)}function r(t){$(".gallery.lightbox",t).on("click","a",function(t){var n=$(this),i=n.parents(".gallery"),r=i.children(".modal"),o=r.find("img"),a=n.attr("href");a&&a.match(/\.(jpg|gif|png|mp4)$/)&&(t.preventDefault(),t.stopPropagation(),r[0]._locked||(r[0]._locked=!0,r.data("cur",n),o.attr("src",a),r.addClass("visible"),r.focus(),e.$main.addClass("no-scroll"),setTimeout(function(){r[0]._locked=!1},300)))}).on("click",".modal",function(t){var n=$(this),i=n.find("img");n[0]._locked||n.hasClass("visible")&&(n[0]._locked=!0,n.removeClass("loaded"),setTimeout(function(){n.removeClass("visible"),e.$main.removeClass("no-scroll"),setTimeout(function(){i.attr("src",""),n[0]._locked=!1,n.removeData("cur"),e.$body.focus()},175)},125))}).on("click",".prev",function(e){var t=$(this).parents(".gallery").children(".modal"),n=t.data("cur");if(n){var i=n.parent().prev().find("a");i&&i.length||(i=n.parent().parent().children().last().find("a")),i&&i.length&&i.trigger("click")}}).on("click",".next",function(e){var t=$(this).parents(".gallery").children(".modal"),n=t.data("cur");if(n){var i=n.parent().next().find("a");i&&i.length||(i=n.parent().parent().children().first().find("a")),i&&i.length&&i.trigger("click")}}).on("keydown",".modal",function(e){var t=$(this);switch(e.keyCode){case 27:t.trigger("click");break;case 37:t.parent().find(".prev").trigger("click");break;case 39:t.parent().find(".next").trigger("click")}}).prepend('<div class="modal" tabIndex="-1"><a class="prev icon style2 fa-angle-left"></a><div class="inner"><img src="" /></div><a class="next icon style2 fa-angle-right"></a></div>').find("img").on("load",function(e){var t=$(this),n=t.parents(".modal");setTimeout(function(){n.hasClass("visible")&&n.addClass("loaded")},275)})}n.init=i}(t.gallery||(t.gallery={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(e){!function(t){function n(e){$(".map",e).q().ForEach(function(e){return l.push(i(e))})}function i(e){var t={element:e},n=parseFloat(e.attr("lat")),i=parseFloat(e.attr("lng")),l=parseFloat(e.attr("zoom"));return n&&i&&(t.start={lat:n,lng:i}),l&&(t.zoom=l),t.marker=$q($(".marker",e)).Select(function(e){return{position:{lat:parseFloat(e.attr("lat")),lng:parseFloat(e.attr("lng"))},title:e.text()}}).ToArray(),window["initMap"+s]=function(){r(t)},o?r(t):(e.after('<script async defer src="https://maps.googleapis.com/maps/api/js?key='+a+"&callback=initMap"+s+'"><\/script>'),o=!0),s++,t}function r(t){var n,i=new google.maps.Map(t.element[0],{center:t.start?{lat:t.start.lat,lng:t.start.lng}:null,zoom:t.zoom,styles:e.mapStyle});$q(t.marker).ForEach(function(e){new google.maps.Marker({position:new google.maps.LatLng(e.position.lat,e.position.lng),title:e.title}).setMap(i)});t.element.mouseenter(function(){n||(n=t.element.children().first(),n.mouseleave(function(){n.addClass("no-pointer-events")})),n.addClass("no-pointer-events")}),t.element.click(function(){n.removeClass("no-pointer-events")})}var o,a="AIzaSyBdO_cpM267sMdq2GO-ujjfch3dMjUHMjY",s=0,l=[];t.init=n}(e.map||(e.map={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(e){e.mapStyle=[{stylers:[{saturation:-100},{gamma:1}]},{elementType:"labels.text.stroke",stylers:[{visibility:"off"}]},{featureType:"poi.business",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"poi.business",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"poi.place_of_worship",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"poi.place_of_worship",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"geometry",stylers:[{visibility:"simplified"}]},{featureType:"water",stylers:[{visibility:"on"},{saturation:50},{gamma:0},{hue:"#50a5d1"}]},{featureType:"administrative.neighborhood",elementType:"labels.text.fill",stylers:[{color:"#333333"}]},{featureType:"road.local",elementType:"labels.text",stylers:[{weight:.5},{color:"#333333"}]},{featureType:"transit.station",elementType:"labels.icon",stylers:[{gamma:1},{saturation:50}]}]}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){!function(n){function i(){t.link.init(s),a.click(function(){e.$main.hasClass("menu-opened")?o():r()}),s.click(function(e){var t=$(e.target);("menu"==t.attr("id")||t.hasClass("icon"))&&o()})}function r(){a.addClass("fa-close").removeClass("fa-bars"),e.$main.addClass("menu-opened").addClass("no-scroll"),s.addClass("opened")}function o(){a.addClass("fa-bars").removeClass("fa-close"),e.$main.removeClass("menu-opened").removeClass("no-scroll"),s.removeClass("opened")}var a=$("#menu-btn"),s=$("#menu");n.init=i,n.open=r,n.close=o}(t.menu||(t.menu={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){$.fn.timeline=function(){return this.data("timeline")};!function(e){function t(e){$(".timeline",e).each(function(e,t){new n($(t))})}e.init=t}(t.timeline||(t.timeline={}));var n=function(){function n(n){this.element=n.data("timeline",this),this.page=e.$util.getPage(this.element),this.initBlocks(),this.initScrolling(),t.link.init(n)}return n.prototype.initScrolling=function(){var t=this;this.hideBlocks(),e.$window.on("scroll",function(){t&&t.hasBlocks()&&t.pageIsActive()&&(window.requestAnimationFrame?window.requestAnimationFrame(function(){t.showBlocks()}):setTimeout(function(){t.showBlocks()},100))})},n.prototype.hasBlocks=function(){return this.blocks&&this.blocks.length>0},n.prototype.pageIsActive=function(){return this.page&&this.page.pageCnt.hasClass("current")},n.prototype.initBlocks=function(){this.blocks=$(".timeline-block",this.element)},n.prototype.hideBlocks=function(){var e=this;this.blocks.each(function(t,n){e.hideBlock($(n))})},n.prototype.showBlocks=function(){var e=this;this.blocks.each(function(t,n){e.showBlock($(n))})},n.prototype.refreshBlocks=function(){var e=this;this.blocks.each(function(t,n){var i=$(n);e.hideBlock(i),e.showBlock(i)})},n.prototype.hideBlock=function(t){t.offset().top>e.$window.scrollTop()+e.$window.height()*n.offset&&t.find(".timeline-img, .timeline-content").addClass("is-hidden")},n.prototype.showBlock=function(t){t.offset().top<=e.$window.scrollTop()+e.$window.height()*n.offset&&t.find(".timeline-img").hasClass("is-hidden")&&t.find(".timeline-img, .timeline-content").removeClass("is-hidden").addClass("bounce-in")},n.offset=.8,n}();t.Timeline=n}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(e){!function(e){function t(e,t){return new n(e,t)}e.init=t;var n=function(){function e(t,n){var i=this;this.context=t,this.context.each(function(e,t){$(t).data("scrollex",i)});var r=this,o=n.initialize,a=n.terminate,s=n.enter,l=n.leave;this.options=n=$.extend({},e.defaultOptions,n,{initialize:function(){r.initialize($(this),o)},terminate:function(){r.terminate($(this),a)},enter:function(){r.enter($(this),s)},leave:function(){r.leave($(this),l)}}),this.context.scrollex(n)}return e.prototype.initialize=function(e,t){!this.options.enabled||t&&!1===t(this,e)||e.addClass(this.options.inactiveClass)},e.prototype.terminate=function(e,t){!this.options.enabled||t&&!1===t(this,e)||e.removeClass(this.options.inactiveClass)},e.prototype.enter=function(e,t){!this.options.enabled||t&&!1===t(this,e)||e.removeClass(this.options.inactiveClass)},e.prototype.leave=function(e,t){if(this.options.enabled&&(!t||!1!==t(this,e))){var n=this.options;(1==n.bidirectional||n.bidirectional&&e.hasClass(n.bidirectional))&&e.addClass(n.inactiveClass)}},e.defaultOptions={enabled:!0,top:"30vh",bottom:"30vh",inactiveClass:"is-inactive",bidirectional:"onscroll-bidirectional"},e}();e.Scrollex=n}(e.scrollex||(e.scrollex={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){function n(e,n){c(e),t.section.init(e,n),t.img.init(e),t.items.init(e),t.events.init(e),t.gallery.init(e),t.timeline.init(e),t.map.init(e),t.link.init(e),t.$scrollCnt.trigger("scroll")}function i(){l(),a(),s(),t.menu.init()}function r(t,n,i,r,a){a||(a=$.Deferred());var s=t.page||"main";return e.$pages.exists(s+"-"+t.dest)&&(s+="-"+t.dest),e.$pages.load(s).done(function(s){var l=t.dest?$("#"+t.dest):null;l&&l.length||(l=s.pageCnt),n||(n=l.attr("anchor")||"top"),i||(i=l.attr("speed")||"normal");var c;r&&(c=s.remOffset()),void 0==c&&(c=e.$util.getOffset(l,n)),o(c,n,i,a)}),a.promise()}function o(e,n,i,r){if(void 0===n&&(n="top"),void 0===i&&(i="normal"),r||(r=$.Deferred()),"immediate"==i)t.$scrollCnt.stop().scrollTop(e),setTimeout(function(){r.resolve()},100);else{var o=1e3;"slow"==i?o=2e3:"fast"==i&&(o=300),t.$scrollCnt.stop().animate({scrollTop:e},o,"swing",function(){r.resolve()})}return r.promise()}function a(){t.$backBtn.click(function(t){t&&t.preventDefault(),e.$app.back()})}function s(){var t=$("#lang-btn"),n=function(n){var i=e.$window.height(),r=e.$window.scrollTop();t.toggleClass("hidden",r>i/2||e.$pages.current&&e.$pages.current.pageCnt.hasClass("no-lang-btn"))};e.$window.scroll(n),e.$window.resize(n),n()}function l(){if("ie"==skel.vars.browser){var t;e.$window.on("resize.flexbox-fix",function(){var n=$(".fullscreen");clearTimeout(t),t=setTimeout(function(){n.prop("scrollHeight")>e.$window.height()?n.css("height","auto"):n.css("height","100vh")},250)}).triggerHandler("resize.flexbox-fix")}}function c(e){skel.canUse("object-fit")||$(".banner .image, .spotlight .image",e).each(function(e,t){var n=$(t),i=n.children("img"),r=n.parent().attr("class").match(/image-position-([a-z]+)/);switch(n.css("background-image",'url("'+i.attr("src")+'")').css("background-repeat","no-repeat").css("background-size","cover"),r.length>1?r[1]:""){case"left":n.css("background-position","left");break;case"right":n.css("background-position","right");break;case"center":default:n.css("background-position","center")}i.css("opacity","0")})}t.$scrollCnt=$("body,html"),t.$backBtn=$("#back-btn"),t.init=n,t.initCommon=i,t.scrollTo=r,t.scrollToPos=o}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){!function(n){var i=function(){function e(e,t){this.name=e,this.parse=t}return e.prototype.q=function(){return new r(this)},e}();n.DBTable=i;var r=function(){function n(t){this._table=t,this._url="/"+e.$cfg.ctx.db+"/_table/"+t.name}return n.prototype.select=function(e){return this._select=e,this},n.prototype.where=function(e){return this._where=e,this},n.prototype.related=function(e){return this._related=e,this},n.prototype.orderBy=function(e){return this._orderBy=e,this},n.prototype.groupBy=function(e){return this._groupBy=e,this},n.prototype.limit=function(e){return this._limit=e,this},n.prototype.offset=function(e){return this._offset=e,this},n.prototype.parseSingle=function(e){return e?this._table.parse?this._table.parse(e):e:null},n.prototype.parseMany=function(e){var t=this;return e&&e.resource?this._table.parse?$q(e.resource).Select(function(e){return t._table.parse(e)}).ToArray():e.resource:[]},n.prototype.get=function(e){var n=this,i={};return this._select&&(i.fields=this._select),t.get(this._url+"/"+e,i).then(function(e){return n.parseSingle(e)})},n.prototype.find=function(){var e=this,n={};return this._select&&(n.fields=this._select),this._where&&(n.filter=this._where),this._orderBy&&(n.order=this._orderBy),this._groupBy&&(n.group=this._groupBy),this._limit&&(n.limit=this._limit),this._offset&&(n.offset=this._offset),this._related&&(n.related=this._related),t.get(this._url,n).then(function(t){return e.parseMany(t)})},n}();n.DBQuery=r,n.event=new i("event",function(t){return new e.MTBEvent(t)})}(t.db||(t.db={}))}(e.$ctx||(e.$ctx={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(e){!function(t){function n(){return(t.current?t.current.session_token:null)||Cookies.get(l)}function i(t,n,i){return void 0===i&&(i=0),e.post("/user/session",{email:t,password:n,duration:i||0}).then(function(e){return s(e)}).fail(function(e,t,n){return s(null)})}function r(t){return e.post("/hashauth",{hash:t}).then(function(e){return s(e)}).fail(function(e,t,n){return s(null)})}function o(){return t.current&&t.current.session_token?e.del("/user/session").then(function(){return s(null)}):$.Deferred().resolve().promise()}function a(){var n=t.current?t.current.session_token:null;return n||(n=Cookies.get(l)),n?e.put("/user/session").then(function(e){return s(e)}).fail(function(e,t,n){return s(null)}):$.Deferred().reject().promise()}function s(e){return t.current=e,t.current?Cookies.set(l,t.current.session_token,{expires:1}):Cookies.remove(l),t.current}var l="alpbros_session";t.current=null,t.token=n,t.signin=i,t.hashauth=r,t.signout=o,t.refresh=a}(e.session||(e.session={}))}(e.$ctx||(e.$ctx={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){function n(n,i,r){return!r||"POST"!=n&&"PUT"!=n||(r=JSON.stringify(r)),$.ajax({type:n,url:e.$cfg.ctx.baseurl+i,data:r||{},accepts:{json:"application/json"},contentType:"application/json",headers:{"X-DreamFactory-API-Key":e.$cfg.ctx.apikey,"X-DreamFactory-Session-Token":t.session.token()}})}function i(e,t){return n("GET",e,t)}function r(e,t){return n("POST",e,t)}function o(e,t){return n("PUT",e,t)}function a(e,t){return n("DELETE",e,t)}t.call=n,t.get=i,t.post=r,t.put=o,t.del=a}(e.$ctx||(e.$ctx={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(e){var t=function(){function e(e,t,n){this.name=e,this.pageCnt=t,this.pageCnt.data("page",this)}return e.prototype.isCurrent=function(){return this.pageCnt.hasClass("current")},e.prototype.isHidden=function(){return this.pageCnt.hasClass("hidden")},e.prototype.defaultBack=function(){return this.pageCnt.attr("back")},e.prototype.remOffset=function(e){if(null===e)this.pageCnt.removeAttr("offset");else{if(void 0===e){var t=this.pageCnt.attr("offset");return null!=t?parseInt(t):null}this.pageCnt.attr("offset",e)}},e.prototype.load=function(e){e&&e.resolve(this)},e}();e.Page=t}(e.$pages||(e.$pages={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){var n=function(t){function n(n,i,r){var o=t.call(this,n,i,r)||this;return e.$ui.initCommon(),e.$ui.init(i,{setHashOnScroll:Modernizr.history}),r.resolve(o),o}return __extends(n,t),n}(t.Page);t.PageMain=n}(e.$pages||(e.$pages={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){var n=function(t){function n(n,i,r){var o=t.call(this,n,i,r)||this;return o.timelineCnt=$("#event-timeline"),e.$data.waitEvents.done(function(){o.appendEvents(),e.$ui.init(i),o.initForm(),o.timeline=o.timelineCnt.timeline(),o.filterTimeline(),r.resolve(o)}).fail(function(){r.reject()}),o}return __extends(n,t),n.prototype.load=function(e){this.timeline.hasBlocks()||this.timeline.initBlocks(),this.timeline.refreshBlocks(),e.resolve(this)},n.prototype.initForm=function(){var t=this;$("input#event-from-date").val((new Date).toISOString().substr(0,10));var n=$("select#event-type");$q(e.MTBEventTypes).ForEach(function(e){var t=e.Value;n.append('<option value="'+t.id+'">'+t.description+"</option>")}),$("input,select").change(function(){return t.filterTimeline()})},n.prototype.appendEvents=function(){var t=this;this.timelineItems=$q(e.$data.events).Select(function(e){return{event:e,item:t.getTimelineItem(e)}}).ToArray(),this.timelineCnt.append($q(this.timelineItems).Select(function(e,t){return e.item.toggleClass("even",t%2!=0)}).ToArray())},n.prototype.filterTimeline=function(){var t,n=(t=$("#event-from-date").val())?moment(t):null,i=(t=$("#event-to-date").val())?moment(t):null,r=$("#event-type").val(),o=e.MTBLevel.Everyone|($("#event-level-beginner").is(":checked")?e.MTBLevel.Beginner:e.MTBLevel.Everyone)|($("#event-level-advanced").is(":checked")?e.MTBLevel.Advanced:e.MTBLevel.Everyone),a=0;$q(this.timelineItems).ForEach(function(t){var s=t.event,l=n&&s.from()<n||i&&s.to()>i||r&&"all"!=r&&s.typeId()!=r||o<e.MTBLevel.All&&s.level()!=e.MTBLevel.Everyone&&0==(s.level()&o);t.item.toggleClass("hidden",l),l||(t.item.toggleClass("even",a%2!=0).toggleClass("first-child",0==a),a++)}),this.timeline.refreshBlocks()},n.prototype.getTimelineItem=function(t){var n=t.isErlebniscard()?e.$res.events.erlebniscardPrice:t.price(),i="#/event?id="+t.eventId();return $('<div class="timeline-block" eventId="'+t.eventId()+'"><div class="timeline-img bg-color-'+this.getLevelColor(t)+'" title="'+t.type().name+'"><span class="icon style2 major '+t.type().icon+'"></span></div><div class="timeline-content"><h3>'+t.name()+'<br /><code><span class="icon fa-money"></span> '+n+'</code></h3><p><img src="'+t.img()+'" /><strong>'+e.$util.formatFromTo(t.from(),t.to(),e.$res.events.dateFormat,e.$res.events.multiDayFormat)+"<br />"+e.$res.events.level+": "+e.$res.level[e.MTBLevel[t.level()]]+"</strong><br /><br />"+t.description()+'</p><br style="clear: both;" /><a href="'+i+'" class="button special icon fa-pencil">Details & Anmeldung</a><span class="date">'+e.$util.formatDate(t.from(),e.$res.events.fromFormat)+"</span></div></div>").data("event",t)},n.prototype.getLevelColor=function(t){switch(t.level()){case e.MTBLevel.Beginner:return"green";case e.MTBLevel.Advanced:return"orange";default:return"blue"}},n}(t.Page);t.PageEvents=n}(e.$pages||(e.$pages={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){var n=function(t){function n(n,i,r){var o=t.call(this,n,i,r)||this;return e.$data.waitEvents.done(function(){e.$ui.init(i),r.resolve(o)}),o}return __extends(n,t),n.prototype.load=function(t){var n=e.$url.args||{},i=n.id;if(!i)return void(t&&t.reject("Missing eventId and/or date!"));var r=$q(e.$data.events).FirstOrDefault(null,function(e){return e.eventId()==i});if(!r)return void(t&&t.reject("Event not found for '"+e.$url.hash+"'!"));var o=n.tpl||r.tpl()||"default",a=$(">section.common, >section."+o,this.pageCnt).removeClass("hidden");$(">section:not(.common, ."+o+")",this.pageCnt).addClass("hidden"),this.pageCnt.toggleClass("erlebniscard","Erlebniscard"==r.price()),$(".event-name",a).text(r.name()),$(".event-price-text",a).text(r.price()),$(".event-info",a).html(e.$util.formatFromTo(r.from(),r.to(),e.$res.events.dateFormat,e.$res.events.multiDayFormat)+"<br />"+e.$res.events.level+": "+e.$res.level[e.MTBLevel[r.level()]]),$(".event-text",a).html(r.description()),t&&t.resolve(this)},n}(t.Page);t.PageEvent=n}(e.$pages||(e.$pages={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){var n=function(t){function n(e,n,i){var r=t.call(this,e,n,i)||this,o=["type","level","name-de","name-en","short-descr-de","short-descr-en","descr-de","descr-en","requirements-de","requirements-en","from","to"];return $q(o).ForEach(function(e){r[e.replace(/-/g,"_")]=r.input(e)}),r.img=$(".event-img",n).click(function(){$(".event-img.selected").removeClass("selected"),$(this).addClass("selected")}),r.datesTbl=$("table.dates",n),$("a.add-date",r.datesTbl).click(function(){return r.addDate()}),i.resolve(r),r}return __extends(n,t),n.prototype.load=function(t){this.pageCnt.attr("mode",e.$url.dest||"edit"),this.dates=[],t&&t.resolve(this)},n.prototype.addDate=function(){var e=moment(this.from.val()),t=moment(this.to.val());return e.isValid()?t.isValid()?$q(this.dates).Any(function(n){return n.from.isSame(e)&&n.to.isSame(t)})?alert("Duplicate date"):(this.dates.push({from:e,to:t}),void this.refreshDatesTbl()):alert("Invalid to date!"):alert("Invalid from date!")},n.prototype.refreshDatesTbl=function(){var e=this,t=$("tbody",this.datesTbl).empty();$q(this.dates).OrderBy(function(e){return e.from}).ForEach(function(n){t.append(e.getDateRow(n))})},n.prototype.getDateRow=function(t){var n=this;return $("<tr>").data("date",t).append($("<td>").text(t.from.format(e.$res.event.edit.dateFormat)),$("<td>").text(t.to.format(e.$res.event.edit.dateFormat)),$("<td>").append($("<a>").addClass("icon style2 fa-repeat").attr("title",e.$res.event.edit.repeat).click(function(){var e={from:t.from.clone().add(7,"days"),to:t.to.clone().add(7,"days")};n.dates.push(e),n.refreshDatesTbl()}),$("<a>").addClass("icon style2 fa-minus").click(function(){n.dates=$q(n.dates).Where(function(e){return e!==t}).ToArray(),n.refreshDatesTbl()})))},n.prototype.input=function(e){return $("input[name='event-"+e+"']",this.pageCnt)},n}(t.Page);t.PageEventEdit=n}(e.$pages||(e.$pages={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){var n=function(t){function n(n,i,r){var o=t.call(this,n,i,r)||this;return e.$ui.init(i),o.signInBtn=$("#signin-btn",i).click(function(e){e&&e.preventDefault(),o.signIn()}),o.email=$("#signin-email",o.pageCnt),o.pwd=$("#signin-pwd",o.pageCnt),o.errorLbl=$("#signin-error",o.pageCnt),r.resolve(o),o}return __extends(n,t),n.prototype.signIn=function(){var t=this;e.$ui.loader.show(),e.$cmd.exec("signin",{email:this.email.val(),pwd:this.pwd.val(),return:e.$url.args?e.$url.args.return:null}).always(function(){e.$ui.loader.hide(),t.email.val(""),t.pwd.val("")}).done(function(){t.errorLbl.addClass("hidden")}).fail(function(e,n,i){t.errorLbl.text(i).removeClass("hidden")})},n}(t.Page);t.PageSignin=n}(e.$pages||(e.$pages={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){var n=function(t){function n(n,i,r){var o=t.call(this,n,i,r)||this;return e.$ui.init(i),r.resolve(o),o}return __extends(n,t),n.prototype.load=function(t){var n=e.$ctx.session.current;if(!n||n.role_id!=e.Roles.Admin)return void t.reject({redirect:"#/signin?return=/admin"});t.resolve(this)},n}(t.Page);t.PageAdmin=n}(e.$pages||(e.$pages={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){function n(i,l){var p=e.$cfg.pages[i];if(null==p)return $.Deferred().reject("Missing page "+i).promise();if(p.synname)return n(p.synname,l);var f=c[i];if(!f){var d,f=$.Deferred().fail(function(e){r(e,i,l)}),h=s(i);if(!h&&!(d=a(i)))return f.reject().promise();h?f.resolve(h):(l||e.$ui.loader.show(),o(i).then(function(e){h=u[i]=new d(i,e,f),d==t.Page&&f.resolve(h)},function(){f.reject()}))}return(c[i]=f.then(function(e){if(!e.load||l)return e;var t=$.Deferred();return e.load(t),t}).then(function(n){return t.current||(t.current=n),l||(e.$ui.loader.hide(),t.current!=n&&(t.current&&(t.current.pageCnt.removeClass("current").addClass("hidden"),t.current.pageCnt.trigger("pagehide")),(t.current=n).pageCnt.addClass("current").removeClass("hidden"),t.current.pageCnt.trigger("pageload")),e.$ui.$backBtn.toggleClass("hidden",t.current==s("main"))),n})).fail(function(e){r(e,i,l)})}function i(e){return n(e,!0)}function r(t,n,i){if(e.$ui.loader.hide(),delete c[n],t&&t.redirect)return e.$app.hashChange(t.redirect);i||e.$app.back(),console.error("Could not load page "+n+"! "+t)}function o(t){var n=$("#"+t+".page");return n.length>0?$.Deferred().resolve(n).promise():$.ajax({type:"GET",url:"pages/"+t+".html"}).then(function(i){return i||(i='<div id="'+t+'"></div>'),n=$(i),e.$body.append(n),n})}function a(e){var n=e.split("-");return e=$q(n).Select(function(e){return e[0].toUpperCase()+e.substr(1)}).ToArray().join(""),t["Page"+e]||t.Page}function s(e){return u[e]}function l(t){return null!=e.$cfg.pages[t]}var c={},u={};t.load=n,t.preload=i,t.get=s,t.exists=l}(e.$pages||(e.$pages={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){var n=function(){function t(){}return t.prototype.exec=function(t){var n=t.hash,i=t.email,r=t.pwd;if(!(n||i&&r))return $.Deferred().reject("Missing credentials!").promise();var o=t.return||"#/";return e.$ui.loader.show(),(n?e.$ctx.session.hashauth(n):e.$ctx.session.signin(i,r)).always(function(){e.$ui.loader.hide()}).done(function(t){return e.$app.setAuthenticated(!0),e.$app.hashChange(e.$util.ensureStartsWith(o,"#"))}).fail(function(e,t,n){console.error(n)})},t}();t.CmdSignin=n
}(e.$cmd||(e.$cmd={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){var n=function(){function t(){}return t.prototype.exec=function(t){return e.$ctx.session.signout().always(function(){e.$app.back()}).done(function(){e.$app.setAuthenticated(!1)})},t}();t.CmdSignout=n}(e.$cmd||(e.$cmd={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(e){function t(t,n){var i=e["Cmd"+t[0].toUpperCase()+t.substr(1)];return i?(new i).exec(n||{}):$.Deferred().reject("Cmd "+t+" not found!").promise()}function n(e){return e&&"cmd"==e.page&&e.dest?t(e.dest,e.args):$.Deferred().reject("Invalid cmd url '"+(e?e.hash:"")+"'").promise()}e.exec=t,e.execUrl=n;var i=function(){function e(){}return e.prototype.exec=function(e){return $.Deferred().resolve().promise()},e}();e.Cmd=i}(e.$cmd||(e.$cmd={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){e.$window=$(window),e.$doc=$(document.documentElement),e.$body=$(document.body),e.$main=$("#main.page");!function(t){function n(t){e.$cfg.init(t),Modernizr.history&&(history.scrollRestoration="manual",c=history.length),e.$window.on("hashchange",function(){u||i()}),Modernizr.history&&e.$window.on("popstate",function(){p||(f=!0)});var n;e.$doc.click(function(){n||(e.$ctx.session.refresh().done(function(){l(!0)}).fail(function(){l(!1)}),n=setTimeout(function(){n=null},15e3))}),e.$data.init(),e.$ctx.session.refresh().done(function(){l(!0)}).fail(function(){l(!1)}).always(function(){e.$pages.preload("main").done(function(){i(void 0,void 0,"immediate").done(function(){$q(e.$cfg.pages).Where(function(e){return e.Value.preload}).ForEach(function(t){return e.$pages.preload(t.Key)})})})})}function i(n,i,a){if(u=!0,f||(p=!0),e.$url=e.$util.parseUrl(n||window.location.hash),"cmd"==e.$url.page)return e.$cmd.execUrl(e.$url).fail(function(e){return console.error(e),t.back()});var s=e.$pages.current&&e.$url.page!=e.$pages.current.name;n&&window.location.hash!=n&&(s&&(e.$ui.$backBtn.attr("href",window.location.hash),window.location.hash=n),Modernizr.history&&o(n)),s&&(a="immediate",document.title=r(e.$url),f||e.$pages.current.remOffset(e.$window.scrollTop()));var l=e.$url.args;return l&&(l.anchor&&(i=l.anchor),l.speed&&(a=l.speed)),e.$ui.scrollTo(e.$url,i,a,f).done(function(){u=p=f=!1})}function r(t){var n=e.$res[t.page],i=t.dest&&n?n[t.dest]:null;return i&&i.title?i.title:n&&n.title?n.title:e.$res.main.title}function o(e){history.replaceState(e,void 0,e)}function a(){i("#/")}function s(t){f=!0,t||(t=e.$ui.$backBtn.attr("back")||e.$pages.current&&e.$pages.current.defaultBack()||"#/"),i(t)}function l(t){e.$doc.toggleClass("authenticated",t).toggleClass("unauthenticated",!t)}var c,u=!1,p=!1,f=!1;t.init=n,t.hashChange=i,t.setHash=o,t.home=a,t.back=s,t.setAuthenticated=l}(e.$app||(e.$app={})),skel.breakpoints({xlarge:"(max-width: 1680px)",large:"(max-width: 1280px)",medium:"(max-width: 980px)",small:"(max-width: 736px)",xsmall:"(max-width: 480px)",xxsmall:"(max-width: 360px)",minxlarge:"(min-width: 1680px)",minlarge:"(min-width: 1280px)",minmedium:"(min-width: 980px)",minsmall:"(min-width: 736px)",minxsmall:"(min-width: 480px)",minxxsmall:"(min-width: 360px)"})}($alpbros||($alpbros={}));