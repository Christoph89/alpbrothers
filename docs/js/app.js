"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),$alpbros;!function(e){!function(e){e[e.None=0]="None",e[e.Beginner=1]="Beginner",e[e.Advanced=2]="Advanced",e[e.All=3]="All"}(e.MTBLevel||(e.MTBLevel={})),e.MTBEventTypes={None:{id:0,name:"none",icon:"",offer:!1},TechniqueTraining:{id:1,name:"",icon:"fa-cogs",offer:!0},GuidedTour:{id:2,name:"",icon:"fa-bicycle",offer:!0},Camp:{id:3,name:"",icon:"fa-home",offer:!0},MechanicalTraining:{id:4,name:"",icon:"fa-wrench",offer:!0}};!function(t){function n(e){return e?(e.events&&(e.events=$q(e.events).Select(function(t){return i(t,e)}).ToArray()),e.allEvents=$q(e.events).SelectMany(function(e){return e.recurrences}).OrderBy(function(e){return e.from}).ToArray(),e):null}function i(t,n){return t?(n||(n=e.$meta),t.type&&(t.type=$q(e.MTBEventTypes).FirstOrDefault({Key:"None",Value:e.MTBEventTypes.None},function(e){return e.Value.id==t.type}).Value),t.from&&(t.from=new Date(t.from),t.isofrom=moment(t.from).format("YYYY-MM-DD")),t.to&&(t.to=new Date(t.to)),t.recurrences=e.$util.getRecurrences(t),t):null}t.meta=n,t.event=i}(e.$parse||(e.$parse={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){function n(e,t){return moment(e).format(t)}function i(e,t,n,i){i&&!o(e,t)&&(n=i);var r=n.split("-");return moment(e).format(r[0].trim())+" - "+moment(t).format(r[1].trim())}function o(e,t){return e.getFullYear()==t.getFullYear()&&e.getMonth()==t.getMonth()&&e.getDate()==t.getDate()}function r(e,t){return null==e&&(e=""),e[0]==t?e:t+e}function a(e,t){if(void 0===t&&(t="top"),e="string"==typeof e?$(e):e,0==e.length)return null;var n=e.offset().top;return"middle"==t?n-($(window).height()-e.outerHeight())/2:Math.max(n,0)}function s(e){var t=[e],n="string"==typeof e.img?[e.img]:e.img;if(e.img=n[0],!e.repeat)return t;var i,o,r=parseInt(e.repeat);if(isNaN(r))switch(r=parseInt(e.repeat.substr(1)),e.repeat[0]){case"m":i="Month",o=1;case"w":default:i="Date",o=7}else o=7;for(var a=1;a<=r-1;a++){var s=$.extend({},e);s.repeat=null,s.img=n[a%n.length];var l=new Date(s.from.getTime()),c=new Date(s.to.getTime());l&&(s.from=new Date(l["set"+i](l["get"+i]()+o*a)),s.isofrom=moment(s.from).format("YYYY-MM-DD")),c&&(s.to=new Date(c["set"+i](c["get"+i]()+o*a))),t.push(s)}return t}function l(t,n){n||(n="name");var i=t[n+"_"+e.$cfg.lang];return void 0===i&&(i=t[n]),i}function c(e){for(var t=e;t&&!t.hasClass("page");)t=t.parent();return t.hasClass("page")?t.data("page"):null}function u(t){t=t.replace("#/","").replace("#","");var n={hash:"#/"+t},i=t.split("?"),o=(i[0]||"").split("/");return n.page=o[0],e.$cfg.pages.indexOf(n.page)<0?(n.dest=n.page,n.page="main"):n.dest=o[o.length-1],n.args=p(i[1]),n}function p(e){if(!e)return null;var t={};return $q(e.split("&")).ForEach(function(e){var n=e.split("=");t[n[0]]=n[1]}),t}t.formatDate=n,t.formatFromTo=i,t.dateEquals=o,t.ensureStartsWith=r,t.getOffset=a,t.getRecurrences=s,t.localize=l,t.getPage=c,t.parseUrl=u,t.splitArgs=p}(e.$util||(e.$util={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){!function(t){function n(){r||(s++,e.$body.addClass("is-loading"),r=setTimeout(function(){l.addClass("show")},a))}function i(){(s=Math.max(0,s-1))>0||(r&&(clearTimeout(r),r=null),l.removeClass("show"),e.$body.removeClass("is-loading"))}function o(e){void 0==e&&(e=!l.hasClass("show")),e?n():i()}var r,a=300,s=0,l=$("#loader");t.show=n,t.hide=i,t.toggle=o}(t.loader||(t.loader={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){!function(n){function i(n,i){var o=(n?e.$util.getPage(n):null)||e.$pages.get("main"),r=[],a=t.scrollex.init($((n?"":".page ")+"> section, section > section",n),{enter:i&&i.setHashOnScroll?function(t,n){if(e.$body.hasClass("is-loading"))return!1;var i=n.attr("href");i&&(-1==r.indexOf(i)&&r.push(i),1==r.length&&e.$app.setHash(r[0]))}:null,leave:i&&i.setHashOnScroll?function(t,n){if(e.$body.hasClass("is-loading"))return!1;var i=n.attr("href");if(i){var o=r.indexOf(i);o>-1&&(r.splice(o,1),1==r.length&&e.$app.setHash(r[0]))}}:null});o.pageCnt.on("pageload",function(){a.options.enabled=!0}),o.pageCnt.on("pagehide",function(){a.options.enabled=!1})}n.init=i}(t.section||(t.section={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){!function(t){function n(e){$("a",e).each(function(){i($(this))})}function i(t){var n=t.attr("href");n&&"#"==n[0]&&t.off("click.href").on("click.href",function(n){n&&n.preventDefault(),e.$app.hashChange(t.attr("href"),t.attr("anchor"),t.attr("speed"))})}t.init=n}(t.link||(t.link={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(e){!function(e){function t(e){Modernizr.svgasimg||$("img.svg",e).each(function(e,t){var i=$(t);i.hasClass("svg")&&n(i)})}function n(e){var t=e.attr("src");e.attr("src",t.replace(".svg",".png"))}e.init=t}(e.img||(e.img={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(e){!function(t){function n(t){e.scrollex.init($(".items",t),{delay:i}).context.children().wrapInner('<div class="inner"></div>')}var i;t.init=n}(e.items||(e.items={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){!function(t){function n(t){e.$metaPromise.done(function(){$(".event-table table",t).each(function(e,t){i($(t))})})}function i(t){$("tr.dummy",t).remove(),t.prepend($q(e.$meta.allEvents).Take(e.$cfg.shownEvents).Select(function(e){return o(e)}).ToArray())}function o(t){return $("<tr>").addClass("event").append($("<td>").text(moment(t.from).format(e.$res.upcoming.dateFormat))).append($("<td>").append($("<a>")).attr("href",e.$cfg.root+t.url).attr("target","_blank").text(t.name)).append($("<td>").text("Erlebniscard"==t.price?e.$res.events.erlebniscardPrice:t.price))}t.init=n}(t.events||(t.events={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){!function(n){function i(e){t.scrollex.init($(".gallery",e).wrapInner('<div class="inner"></div>').prepend(skel.vars.mobile?"":'<div class="forward"></div><div class="backward"></div>'),{delay:50}).context.children(".inner").css("overflow-y",skel.vars.mobile?"visible":"hidden").css("overflow-x",skel.vars.mobile?"scroll":"hidden").scrollLeft(0),o(e)}function o(t){$(".gallery.lightbox",t).on("click","a",function(t){var n=$(this),i=n.parents(".gallery"),o=i.children(".modal"),r=o.find("img"),a=n.attr("href");a&&a.match(/\.(jpg|gif|png|mp4)$/)&&(t.preventDefault(),t.stopPropagation(),o[0]._locked||(o[0]._locked=!0,o.data("cur",n),r.attr("src",a),o.addClass("visible"),o.focus(),e.$main.addClass("no-scroll"),setTimeout(function(){o[0]._locked=!1},300)))}).on("click",".modal",function(t){var n=$(this),i=n.find("img");n[0]._locked||n.hasClass("visible")&&(n[0]._locked=!0,n.removeClass("loaded"),setTimeout(function(){n.removeClass("visible"),e.$main.removeClass("no-scroll"),setTimeout(function(){i.attr("src",""),n[0]._locked=!1,n.removeData("cur"),e.$body.focus()},175)},125))}).on("click",".prev",function(e){var t=$(this).parents(".gallery").children(".modal"),n=t.data("cur");if(n){var i=n.parent().prev().find("a");i&&i.length||(i=n.parent().parent().children().last().find("a")),i&&i.length&&i.trigger("click")}}).on("click",".next",function(e){var t=$(this).parents(".gallery").children(".modal"),n=t.data("cur");if(n){var i=n.parent().next().find("a");i&&i.length||(i=n.parent().parent().children().first().find("a")),i&&i.length&&i.trigger("click")}}).on("keydown",".modal",function(e){var t=$(this);switch(e.keyCode){case 27:t.trigger("click");break;case 37:t.parent().find(".prev").trigger("click");break;case 39:t.parent().find(".next").trigger("click")}}).prepend('<div class="modal" tabIndex="-1"><a class="prev icon style2 fa-angle-left"></a><div class="inner"><img src="" /></div><a class="next icon style2 fa-angle-right"></a></div>').find("img").on("load",function(e){var t=$(this),n=t.parents(".modal");setTimeout(function(){n.hasClass("visible")&&n.addClass("loaded")},275)})}n.init=i}(t.gallery||(t.gallery={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(e){!function(t){function n(e){$(".map",e).q().ForEach(function(e){return l.push(i(e))})}function i(e){var t={element:e},n=parseFloat(e.attr("lat")),i=parseFloat(e.attr("lng")),l=parseFloat(e.attr("zoom"));return n&&i&&(t.start={lat:n,lng:i}),l&&(t.zoom=l),t.marker=$q($(".marker",e)).Select(function(e){return{position:{lat:parseFloat(e.attr("lat")),lng:parseFloat(e.attr("lng"))},title:e.text()}}).ToArray(),window["initMap"+s]=function(){o(t)},r?o(t):(e.after('<script async defer src="https://maps.googleapis.com/maps/api/js?key='+a+"&callback=initMap"+s+'"><\/script>'),r=!0),s++,t}function o(t){var n,i=new google.maps.Map(t.element[0],{center:t.start?{lat:t.start.lat,lng:t.start.lng}:null,zoom:t.zoom,styles:e.mapStyle});$q(t.marker).ForEach(function(e){new google.maps.Marker({position:new google.maps.LatLng(e.position.lat,e.position.lng),title:e.title}).setMap(i)});t.element.mouseenter(function(){n||(n=t.element.children().first(),n.mouseleave(function(){n.addClass("no-pointer-events")})),n.addClass("no-pointer-events")}),t.element.click(function(){n.removeClass("no-pointer-events")})}var r,a="AIzaSyBdO_cpM267sMdq2GO-ujjfch3dMjUHMjY",s=0,l=[];t.init=n}(e.map||(e.map={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(e){e.mapStyle=[{stylers:[{saturation:-100},{gamma:1}]},{elementType:"labels.text.stroke",stylers:[{visibility:"off"}]},{featureType:"poi.business",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"poi.business",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"poi.place_of_worship",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"poi.place_of_worship",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"geometry",stylers:[{visibility:"simplified"}]},{featureType:"water",stylers:[{visibility:"on"},{saturation:50},{gamma:0},{hue:"#50a5d1"}]},{featureType:"administrative.neighborhood",elementType:"labels.text.fill",stylers:[{color:"#333333"}]},{featureType:"road.local",elementType:"labels.text",stylers:[{weight:.5},{color:"#333333"}]},{featureType:"transit.station",elementType:"labels.icon",stylers:[{gamma:1},{saturation:50}]}]}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){!function(n){function i(){t.link.init(s),a.click(function(){e.$main.hasClass("menu-opened")?r():o()}),s.click(function(e){var t=$(e.target);("menu"==t.attr("id")||t.hasClass("icon"))&&r()})}function o(){a.addClass("fa-close").removeClass("fa-bars"),e.$main.addClass("menu-opened").addClass("no-scroll"),s.addClass("opened")}function r(){a.addClass("fa-bars").removeClass("fa-close"),e.$main.removeClass("menu-opened").removeClass("no-scroll"),s.removeClass("opened")}var a=$("#menu-btn"),s=$("#menu");n.init=i,n.open=o,n.close=r}(t.menu||(t.menu={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){$.fn.timeline=function(){return this.data("timeline")};!function(e){function t(e){$(".timeline",e).each(function(e,t){new n($(t))})}e.init=t}(t.timeline||(t.timeline={}));var n=function(){function n(n){this.element=n.data("timeline",this),this.page=e.$util.getPage(this.element),this.initBlocks(),this.initScrolling(),t.link.init(n)}return n.prototype.initScrolling=function(){var t=this;this.hideBlocks(),e.$window.on("scroll",function(){t&&t.hasBlocks()&&t.pageIsActive()&&(window.requestAnimationFrame?window.requestAnimationFrame(function(){t.showBlocks()}):setTimeout(function(){t.showBlocks()},100))})},n.prototype.hasBlocks=function(){return this.blocks&&this.blocks.length>0},n.prototype.pageIsActive=function(){return this.page&&this.page.pageCnt.hasClass("current")},n.prototype.initBlocks=function(){this.blocks=$(".timeline-block",this.element)},n.prototype.hideBlocks=function(){var e=this;this.blocks.each(function(t,n){e.hideBlock($(n))})},n.prototype.showBlocks=function(){var e=this;this.blocks.each(function(t,n){e.showBlock($(n))})},n.prototype.refreshBlocks=function(){var e=this;this.blocks.each(function(t,n){var i=$(n);e.hideBlock(i),e.showBlock(i)})},n.prototype.hideBlock=function(t){t.offset().top>e.$window.scrollTop()+e.$window.height()*n.offset&&t.find(".timeline-img, .timeline-content").addClass("is-hidden")},n.prototype.showBlock=function(t){t.offset().top<=e.$window.scrollTop()+e.$window.height()*n.offset&&t.find(".timeline-img").hasClass("is-hidden")&&t.find(".timeline-img, .timeline-content").removeClass("is-hidden").addClass("bounce-in")},n.offset=.8,n}();t.Timeline=n}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(e){!function(e){function t(e,t){return new n(e,t)}e.init=t;var n=function(){function e(t,n){var i=this;this.context=t,this.context.each(function(e,t){$(t).data("scrollex",i)});var o=this,r=n.initialize,a=n.terminate,s=n.enter,l=n.leave;this.options=n=$.extend({},e.defaultOptions,n,{initialize:function(){o.initialize($(this),r)},terminate:function(){o.terminate($(this),a)},enter:function(){o.enter($(this),s)},leave:function(){o.leave($(this),l)}}),this.context.scrollex(n)}return e.prototype.initialize=function(e,t){!this.options.enabled||t&&!1===t(this,e)||e.addClass(this.options.inactiveClass)},e.prototype.terminate=function(e,t){!this.options.enabled||t&&!1===t(this,e)||e.removeClass(this.options.inactiveClass)},e.prototype.enter=function(e,t){!this.options.enabled||t&&!1===t(this,e)||e.removeClass(this.options.inactiveClass)},e.prototype.leave=function(e,t){if(this.options.enabled&&(!t||!1!==t(this,e))){var n=this.options;(1==n.bidirectional||n.bidirectional&&e.hasClass(n.bidirectional))&&e.addClass(n.inactiveClass)}},e.defaultOptions={enabled:!0,top:"30vh",bottom:"30vh",inactiveClass:"is-inactive",bidirectional:"onscroll-bidirectional"},e}();e.Scrollex=n}(e.scrollex||(e.scrollex={}))}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){function n(e,n){c(e),t.section.init(e,n),t.img.init(e),t.items.init(e),t.events.init(e),t.gallery.init(e),t.timeline.init(e),t.map.init(e),t.link.init(e),t.$scrollCnt.trigger("scroll")}function i(){l(),a(),s(),t.menu.init()}function o(t,n,i,o,a){return a||(a=$.Deferred()),e.$pages.load(t.page||"main").done(function(s){var l=t.dest?$("#"+t.dest):null;l&&l.length||(l=s.pageCnt),n||(n=l.attr("anchor")||"top"),i||(i=l.attr("speed")||"normal");var c;o&&(c=s.remOffset()),void 0==c&&(c=e.$util.getOffset(l,n)),r(c,n,i,a)}),a.promise()}function r(e,n,i,o){if(void 0===n&&(n="top"),void 0===i&&(i="normal"),o||(o=$.Deferred()),"immediate"==i)t.$scrollCnt.stop().scrollTop(e),setTimeout(function(){o.resolve()},100);else{var r=1e3;"slow"==i?r=2e3:"fast"==i&&(r=300),t.$scrollCnt.stop().animate({scrollTop:e},r,"swing",function(){o.resolve()})}return o.promise()}function a(){t.$backBtn.click(function(t){t&&t.preventDefault(),e.$app.back()})}function s(){var t=$("#lang-btn"),n=function(n){var i=e.$window.height(),o=e.$window.scrollTop();t.toggleClass("hidden",o>i/2||e.$pages.current&&e.$pages.current.pageCnt.hasClass("no-lang-btn"))};e.$window.scroll(n),e.$window.resize(n),n()}function l(){if("ie"==skel.vars.browser){var t;e.$window.on("resize.flexbox-fix",function(){var n=$(".fullscreen");clearTimeout(t),t=setTimeout(function(){n.prop("scrollHeight")>e.$window.height()?n.css("height","auto"):n.css("height","100vh")},250)}).triggerHandler("resize.flexbox-fix")}}function c(e){skel.canUse("object-fit")||$(".banner .image, .spotlight .image",e).each(function(e,t){var n=$(t),i=n.children("img"),o=n.parent().attr("class").match(/image-position-([a-z]+)/);switch(n.css("background-image",'url("'+i.attr("src")+'")').css("background-repeat","no-repeat").css("background-size","cover"),o.length>1?o[1]:""){case"left":n.css("background-position","left");break;case"right":n.css("background-position","right");break;case"center":default:n.css("background-position","center")}i.css("opacity","0")})}t.$scrollCnt=$("body,html"),t.$backBtn=$("#back-btn"),t.init=n,t.initCommon=i,t.scrollTo=o,t.scrollToPos=r}(e.$ui||(e.$ui={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){!function(n){var i=function(){function e(e,t){this.name=e,this.parse=t}return e.prototype.q=function(){return new o(this)},e}();n.DBTable=i;var o=function(){function n(t){this._table=t,this._url="/"+e.$cfg.ctx.db+"/_table/"+t.name}return n.prototype.select=function(e){return this._select=e,this},n.prototype.where=function(e){return this._where=e,this},n.prototype.orderBy=function(e){return this._orderBy=e,this},n.prototype.groupBy=function(e){return this._groupBy=e,this},n.prototype.limit=function(e){return this._limit=e,this},n.prototype.offset=function(e){return this._offset=e,this},n.prototype.parseSingle=function(e){return e?this._table.parse?this._table.parse(e):e:null},n.prototype.parseMany=function(e){var t=this;return e&&e.resource?this._table.parse?$q(e.resource).Select(function(e){return t._table.parse(e)}).ToArray():e.resource:[]},n.prototype.get=function(e){var n=this,i={};return this._select&&(i.fields=this._select),t.get(this._url+"/"+e,i).then(function(e){return n.parseSingle(e)})},n.prototype.find=function(){var e=this,n={};return this._select&&(n.fields=this._select),this._where&&(n.filter=this._where),this._orderBy&&(n.order=this._orderBy),this._groupBy&&(n.group=this._groupBy),this._limit&&(n.limit=this._limit),this._offset&&(n.offset=this._offset),t.get(this._url,n).then(function(t){return e.parseMany(t)})},n}();n.DBQuery=o,n.eventType=new i("eventtype"),n.event=new i("event",e.$parse.event)}(t.db||(t.db={}))}(e.$ctx||(e.$ctx={}))}($alpbros||($alpbros={})),function(e){e.$dbEvent=e.$ctx.db.event,e.$dbEventType=e.$ctx.db.eventType}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(e){!function(t){function n(n,i,o){void 0===o&&(o=0),e.post("/user/session",{email:n,password:i,duration:o||0}).done(function(e){t.token=e.session_token})}t.token="",t.login=n}(e.session||(e.session={}))}(e.$ctx||(e.$ctx={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){function n(n,i,o){return!o||"POST"!=n&&"PUT"!=n||(o=JSON.stringify(o)),$.ajax({type:n,url:e.$cfg.ctx.baseurl+i,data:o||{},accepts:"application/json",contentType:"application/json",headers:{"X-DreamFactory-API-Key":e.$cfg.ctx.apikey,"X-DreamFactory-Session-Token":t.session.token}})}function i(e,t){return n("GET",e,t)}function o(e,t){return n("POST",e,t)}function r(e,t){return n("PUT",e,t)}function a(){return i("/meta").then(function(t){return e.$parse.meta(t)})}t.call=n,t.get=i,t.post=o,t.put=r,t.meta=a}(e.$ctx||(e.$ctx={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(e){var t=function(){function e(e,t,n){this.name=e,this.pageCnt=t,this.pageCnt.data("page",this)}return e.prototype.isCurrent=function(){return this.pageCnt.hasClass("current")},e.prototype.isHidden=function(){return this.pageCnt.hasClass("hidden")},e.prototype.defaultBack=function(){return this.pageCnt.attr("back")},e.prototype.remOffset=function(e){if(null===e)this.pageCnt.removeAttr("offset");else{if(void 0===e){var t=this.pageCnt.attr("offset");return null!=t?parseInt(t):null}this.pageCnt.attr("offset",e)}},e.prototype.load=function(e){e&&e.resolve(this)},e}();e.Page=t}(e.$pages||(e.$pages={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){var n=function(t){function n(n,i,o){var r=t.call(this,n,i,o)||this;return e.$ui.initCommon(),e.$ui.init(i,{setHashOnScroll:Modernizr.history}),o.resolve(r),r}return __extends(n,t),n}(t.Page);t.MainPage=n}(e.$pages||(e.$pages={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){var n=function(t){function n(n,i,o){var r=t.call(this,n,i,o)||this;return r.timelineCnt=$("#event-timeline"),e.$metaPromise.done(function(){r.appendEvents(),e.$ui.init(i),r.initForm(),r.timeline=r.timelineCnt.timeline(),r.filterTimeline(),o.resolve(r)}).fail(function(){o.reject()}),r}return __extends(n,t),n.prototype.load=function(e){this.timeline.hasBlocks()||this.timeline.initBlocks(),this.timeline.refreshBlocks(),e.resolve(this)},n.prototype.initForm=function(){var t=this;$("input#event-from-date").val((new Date).toISOString().substr(0,10));var n=$("select#event-type");$q(e.MTBEventTypes).ForEach(function(e){var t=e.Value;n.append('<option value="'+t.id+'">'+t.name+"</option>")}),$("input,select").change(function(){return t.filterTimeline()})},n.prototype.appendEvents=function(){var t=this;this.timelineItems=$q(e.$meta.allEvents).Select(function(e){return{event:e,item:t.getTimelineItem(e)}}).ToArray(),this.timelineCnt.append($q(this.timelineItems).Select(function(e,t){return e.item.toggleClass("even",t%2!=0)}).ToArray())},n.prototype.filterTimeline=function(){var t,n=(t=$("#event-from-date").val())?new Date(t):null,i=(t=$("#event-to-date").val())?new Date(t):null,o=$("#event-type").val(),r=e.MTBLevel.None|($("#event-level-beginner").is(":checked")?e.MTBLevel.Beginner:e.MTBLevel.None)|($("#event-level-advanced").is(":checked")?e.MTBLevel.Advanced:e.MTBLevel.None),a=0;$q(this.timelineItems).ForEach(function(t){var s=t.event,l=n&&s.from<n||i&&s.to>i||o&&"all"!=o&&s.type.id!=o||r<e.MTBLevel.All&&s.level!=e.MTBLevel.None&&0==(s.level&r);t.item.toggleClass("hidden",l),l||(t.item.toggleClass("even",a%2!=0).toggleClass("first-child",0==a),a++)}),this.timeline.refreshBlocks()},n.prototype.getTimelineItem=function(t){var n="Erlebniscard"==t.price?e.$res.events.erlebniscardPrice:t.price,i="#/event?id="+t.id+"&date="+t.isofrom;return $('<div class="timeline-block" eventId="'+t.id+'"><div class="timeline-img bg-color-'+this.getLevelColor(t)+'" title="'+t.type.name+'"><span class="icon style2 major '+t.type.icon+'"></span></div><div class="timeline-content"><h3>'+t.name+'<br /><code><span class="icon fa-money"></span> '+n+'</code></h3><p><img src="'+e.$cfg.root+e.$res.events.imgPath+t.img+'" /><strong>'+e.$util.formatFromTo(t.from,t.to,e.$res.events.dateFormat,e.$res.events.multiDayFormat)+"<br />"+e.$res.events.level+": "+e.$res.level[e.MTBLevel[t.level]]+"</strong><br /><br />"+t.shortText+'</p><br style="clear: both;" /><a href="'+i+'" class="button special icon fa-pencil">Details & Anmeldung</a><span class="date">'+e.$util.formatDate(t.from,e.$res.events.fromFormat)+"</span></div></div>").data("event",t)},n.prototype.getLevelColor=function(t){switch(t.level){case e.MTBLevel.Beginner:return"green";case e.MTBLevel.Advanced:return"orange";default:return"blue"}},n}(t.Page);t.EventsPage=n}(e.$pages||(e.$pages={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){var n=function(t){function n(n,i,o){var r=t.call(this,n,i,o)||this;return e.$metaPromise.done(function(){e.$ui.init(i),o.resolve(r)}),r}return __extends(n,t),n.prototype.load=function(t){var n=e.$url.args||{},i=n.id,o=n.date;if(!i||!o)return void(t&&t.reject("Missing eventId and/or date!"));var r=$q(e.$meta.allEvents).FirstOrDefault(null,function(e){return e.id==i&&e.isofrom==o});if(!r)return void(t&&t.reject("Event not found for '"+e.$url.hash+"'!"));var a=n.tpl||r.tpl||"default",s=$(">section.common, >section."+a,this.pageCnt).removeClass("hidden");$(">section:not(.common, ."+a+")",this.pageCnt).addClass("hidden"),this.pageCnt.toggleClass("erlebniscard","Erlebniscard"==r.price),$(".event-name",s).text(r.name),$(".event-price-text",s).text(r.price),$(".event-info",s).html(e.$util.formatFromTo(r.from,r.to,e.$res.events.dateFormat,e.$res.events.multiDayFormat)+"<br />"+e.$res.events.level+": "+e.$res.level[e.MTBLevel[r.level]]),$(".event-text",s).html(r.shortText),t&&t.resolve(this)},n}(t.Page);t.EventPage=n}(e.$pages||(e.$pages={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){!function(t){function n(n,i){var u=l[n];if(!u){var p,u=$.Deferred().fail(function(e){o(e,n,i)}),f=s(n);if(!f&&!(p=a(n)))return u.reject().promise();f?u.resolve(f):(i||e.$ui.loader.show(),r(n).then(function(e){f=c[n]=new p(n,e,u),p==t.Page&&u.resolve(f)},function(){u.reject()}))}return(l[n]=u.then(function(e){if(!e.load||i)return e;var t=$.Deferred();return e.load(t),t}).then(function(n){return t.current||(t.current=n),i||(e.$ui.loader.hide(),t.current!=n&&(t.current&&(t.current.pageCnt.removeClass("current").addClass("hidden"),t.current.pageCnt.trigger("pagehide")),(t.current=n).pageCnt.addClass("current").removeClass("hidden"),t.current.pageCnt.trigger("pageload")),e.$ui.$backBtn.toggleClass("hidden",t.current==s("main"))),n})).fail(function(e){o(e,n,i)})}function i(e){return n(e,!0)}function o(t,n,i){e.$ui.loader.hide(),delete l[n],i||e.$app.back(),console.error("Could not load page "+n+"! "+t)}function r(t){var n=$("#"+t+".page");return n.length>0?$.Deferred().resolve(n).promise():$.ajax({type:"GET",url:e.$cfg.root+"pages/"+t+".html"}).then(function(i){return i||(i='<div id="'+t+'"></div>'),n=$(i),e.$body.append(n),n})}function a(n){return e.$cfg.pages.indexOf(n)<0?(console.error("Missing page "+n),null):(n=n[0].toUpperCase()+n.substr(1),t[n+"Page"]||t.Page)}function s(e){return c[e]}var l={},c={};t.load=n,t.preload=i,t.get=s}(e.$pages||(e.$pages={}))}($alpbros||($alpbros={}));var $alpbros;!function(e){function t(){$q(e.MTBEventTypes).ForEach(function(t){return $.extend(t.Value,e.$res.eventTypes[t.Key])}),e.$res.months&&e.$res.months.length&&moment.updateLocale("en",{months:e.$res.months,monthsShort:$q(e.$res.months).Select(function(e){return e.substr(0,3)}).ToArray()}),e.$res.weekdays&&e.$res.weekdays.length&&moment.updateLocale("en",{weekdays:e.$res.weekdays,weekdaysShort:$q(e.$res.weekdays).Select(function(e){return e.substr(0,3)}).ToArray(),weekdaysMin:$q(e.$res.weekdays).Select(function(e){return e.substr(0,2)}).ToArray()})}e.$window=$(window),e.$body=$(document.body),e.$main=$("#main.page");!function(n){function i(n){e.$cfg=n,e.$res=e.$cfg.res,t(),Modernizr.history&&(history.scrollRestoration="manual",l=history.length),e.$window.on("hashchange",function(){c||o()}),Modernizr.history&&e.$window.on("popstate",function(){u||(p=!0)}),(e.$metaPromise=e.$ctx.meta()).done(function(t){e.$meta=e.$cfg.meta=$.extend(e.$cfg.meta||{},t)}),e.$pages.preload("main").done(function(){o(void 0,void 0,"immediate").done(function(){$q(e.$cfg.preloadPages).ForEach(function(t){return e.$pages.preload(t)})})})}function o(t,n,i){c=!0,p||(u=!0),e.$url=e.$util.parseUrl(t||window.location.hash);var o=e.$pages.current&&e.$url.page!=e.$pages.current.name;t&&window.location.hash!=t&&(o&&(e.$ui.$backBtn.attr("href",window.location.hash),window.location.hash=t),Modernizr.history&&r(t)),o&&(i="immediate",document.title=(e.$res[e.$url.page]||e.$res.main).title,p||e.$pages.current.remOffset(e.$window.scrollTop()));var a=e.$url.args;return a&&(a.anchor&&(n=a.anchor),a.speed&&(i=a.speed)),e.$ui.scrollTo(e.$url,n,i,p).done(function(){c=u=p=!1})}function r(e){history.replaceState(e,void 0,e)}function a(){o("#/")}function s(t){p=!0,t||(t=e.$ui.$backBtn.attr("back")||e.$pages.current&&e.$pages.current.defaultBack()||"#/"),o(t)}var l,c=!1,u=!1,p=!1;n.init=i,n.hashChange=o,n.setHash=r,n.home=a,n.back=s}(e.$app||(e.$app={})),skel.breakpoints({xlarge:"(max-width: 1680px)",large:"(max-width: 1280px)",medium:"(max-width: 980px)",small:"(max-width: 736px)",xsmall:"(max-width: 480px)",xxsmall:"(max-width: 360px)",minxlarge:"(min-width: 1680px)",minlarge:"(min-width: 1280px)",minmedium:"(min-width: 980px)",minsmall:"(min-width: 736px)",minxsmall:"(min-width: 480px)",minxxsmall:"(min-width: 360px)"})}($alpbros||($alpbros={}));